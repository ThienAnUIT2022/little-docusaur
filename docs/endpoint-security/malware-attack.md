---
title: Malware attacks - Tổng hợp cơ chế tấn công của mã độc
sidebar-position: 4
---

## Bảng tổng hợp

| **Loại Malware**        | **Cơ chế hoạt động**                                                                                         | **Mục đích**                                                      | **Ví dụ**                                                                                                                                         | **Biện pháp phòng chống**                                                                                                                                    |
| ----------------------- | ------------------------------------------------------------------------------------------------------------ | ----------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Virus**               | Lây nhiễm vào các tệp tin hoặc phần mềm hợp lệ, tự nhân bản và lây lan sang các tệp khác khi được kích hoạt. | Phá hủy dữ liệu, làm gián đoạn hoạt động hệ thống.                | Melissa, ILOVEYOU                                                                                                                                 | - Cài đặt phần mềm diệt virus.<br /> - Cập nhật hệ thống thường xuyên.<br />- Không mở tệp đính kèm/tải xuống từ nguồn không đáng tin.                       |
| **Worm**                | Tự nhân bản và lây lan qua mạng mà không cần tệp tin chủ, không cần kích hoạt của người dùng.                | Làm quá tải mạng, đánh cắp dữ liệu, tạo backdoor.                 | [Conficker](https://attack.mitre.org/software/S0608/), [Stuxnet](https://attack.mitre.org/software/S0603/)                                        | - Sử dụng tường lửa và IDS/IPS.<br />- Cập nhật phần mềm mạng và hệ điều hành.<br />- Hạn chế chia sẻ file không cần thiết.                                  |
| **Trojan Horse**        | Ẩn mình trong phần mềm hợp lệ, mở backdoor cho kẻ tấn công.                                                  | Đánh cắp thông tin, theo dõi người dùng, tạo backdoor.            | Zeus, [Emotet](https://attack.mitre.org/software/S0367/)                                                                                          | - Không tải phần mềm từ nguồn không rõ ràng.<br />- Quét file đính kèm trước khi mở.<br />- Sử dụng phần mềm chống Trojan.                                   |
| **Ransomware**          | Mã hóa dữ liệu của nạn nhân và yêu cầu tiền chuộc để giải mã.                                                | Tống tiền, làm gián đoạn hoạt động.                               | [WannaCry](https://attack.mitre.org/software/S0366/), Locky                                                                                       | - Sao lưu dữ liệu định kỳ (backup).<br />- Tránh nhấp vào liên kết/email lạ.<br />- Sử dụng công cụ chống ransomware (ví dụ: CrysisDecryptor).               |
| **Spyware**             | Theo dõi và thu thập thông tin người dùng mà không được phép.                                                | Đánh cắp thông tin cá nhân, theo dõi hoạt động.                   | Keylogger, FinFisher                                                                                                                              | - Cài đặt phần mềm chống spyware.<br />- Tránh truy cập trang web không an toàn.<br />- Sử dụng VPN và mã hóa dữ liệu.                                       |
| **Adware**              | Hiển thị quảng cáo không mong muốn, thường đi kèm với phần mềm miễn phí.                                     | Kiếm lợi nhuận từ quảng cáo, đôi khi thu thập dữ liệu người dùng. | Fireball, Gator                                                                                                                                   | - Sử dụng trình chặn quảng cáo (AdBlock).<br />- Kiểm tra kỹ điều khoản khi cài đặt phần mềm miễn phí.<br />- Quét hệ thống định kỳ.                         |
| **Rootkit**             | Ẩn sâu trong hệ thống, che giấu sự hiện diện của malware.                                                    | Duy trì quyền truy cập ẩn, kiểm soát hệ thống.                    | TDSS, [ZeroAccess](https://attack.mitre.org/software/S0027/)                                                                                      | - Sử dụng công cụ phát hiện rootkit (Ví dụ: GMER).<br />- Cập nhật hệ thống và phần mềm.<br />- Khởi động từ ổ cứng sạch để quét.                            |
| **Backdoor**            | Tạo lối vào ẩn để kẻ tấn công có thể truy cập hệ thống bất cứ lúc nào.                                       | Kiểm soát hệ thống từ xa, đánh cắp dữ liệu.                       | Back Orifice, [DarkComet](https://attack.mitre.org/software/S0334/)                                                                               | - Đóng các cổng mạng không sử dụng.<br />- Sử dụng tường lửa để giám sát kết nối.<br />- Thường xuyên kiểm tra log hệ thống.                                 |
| **Botnet**              | Biến các máy tính bị nhiễm thành "zombie" để thực hiện các tác vụ từ xa.                                     | Thực hiện tấn công DDoS, gửi spam, đào tiền ảo.                   | [Mirai](https://www.cloudflare.com/learning/ddos/glossary/mirai-botnet/), Zeus                                                                    | - Cập nhật phần mềm và firmware.<br />- Sử dụng mật khẩu mạnh cho thiết bị IoT.<br />- Giám sát lưu lượng mạng bất thường.                                   |
| **Cryptojacking**       | Sử dụng tài nguyên máy tính của nạn nhân để đào tiền ảo mà không được phép.                                  | Kiếm lợi nhuận từ việc đào tiền ảo.                               | [Coinhive](https://blog.checkpoint.com/2019/03/11/fe/bruary-2019s-most-wanted-malware-coinhive-quits-gandcrab-cryptomining-ransomware/), BadShell | - Sử dụng tiện ích chặn cryptojacking (Ví dụ: NoCoin).<br />- Giám sát hiệu suất CPU/GPU.<br />- Tránh truy cập trang web đáng ngờ.                          |
| **Fileless Malware**    | Sử dụng các công cụ và tệp tin hợp lệ sẵn có trên hệ thống để thực thi mã độc.                               | Tránh bị phát hiện bởi các phần mềm diệt virus truyền thống.      | Poweliks, Kovter                                                                                                                                  | - Giám sát hoạt động bộ nhớ (RAM).<br />- Sử dụng công cụ EDR (Endpoint Detection and Response).<br />- Vô hiệu hóa PowerShell/WMI không cần thiết.          |
| **Polymorphic Malware** | Thay đổi mã nguồn của nó sau mỗi lần lây nhiễm để tránh bị phát hiện.                                        | Tránh bị phát hiện bởi các phần mềm diệt virus.                   | Storm Worm, Virut                                                                                                                                 | - Sử dụng phần mềm diệt virus dựa trên hành vi (behavior-based).<br />- Cập nhật cơ sở dữ liệu malware thường xuyên.<br />- Phân tích sandbox.               |
| **Macro Malware**       | Sử dụng các macro trong các tài liệu (như Word, Excel) để thực thi mã độc.                                   | Lây nhiễm hệ thống, đánh cắp dữ liệu.                             | Melissa, Locky                                                                                                                                    | - Vô hiệu hóa macro mặc định trong tài liệu.<br />- Chỉ kích hoạt macro từ nguồn tin cậy.<br />- Quét tài liệu bằng phần mềm diệt virus trước khi mở.        |
| **Exploit**             | Lợi dụng các lỗ hổng bảo mật trong phần mềm hoặc hệ thống để thực thi mã độc.                                | Chiếm quyền điều khiển hệ thống, cài đặt malware.                 | EternalBlue, Shellshock                                                                                                                           | - Cập nhật bản vá bảo mật thường xuyên.<br />- Sử dụng hệ thống ngăn chặn khai thác (Ví dụ: EMET).<br />- Kiểm tra lỗ hổng định kỳ (Vulnerability Scanning). |

- **Giải thích thêm**
  - **Virus và Worm**: Khác biệt chính là virus cần một tệp tin chủ để lây lan, trong khi worm có thể tự lây lan qua mạng.
  - **Trojan Horse**: Không tự nhân bản như virus, nhưng thường được sử dụng để mở cửa hậu cho các loại malware khác.
  - **Ransomware**: Ngày càng phổ biến với các biến thể mới như "double extortion" (vừa mã hóa dữ liệu vừa đe dọa công khai dữ liệu).
  - **Fileless Malware**: Khó phát hiện vì không để lại dấu vết trên ổ đĩa, thường sử dụng bộ nhớ RAM để thực thi.

## Kỹ thuật trốn tránh (Evasion Techniques) và ẩn mình (Stealth Techniques)

### Trốn tránh

- **Polymorphism**:

  - **Mô tả**: Malware tự động thay đổi mã nguồn hoặc cấu trúc của nó sau mỗi lần lây nhiễm.
  - **Mục đích**: Tránh bị phát hiện bởi phần mềm diệt virus dựa trên chữ ký (signature-based detection).
  - **Ví dụ**: Virus Storm Worm thay đổi mã nguồn liên tục.

- **Metamorphism**:

  - **Mô tả**: Malware thay đổi toàn bộ mã nguồn và hành vi của nó, không chỉ chữ ký.
  - **Mục đích**: Làm cho việc phát hiện trở nên khó khăn hơn.
  - **Ví dụ**: Malware Virut sử dụng kỹ thuật này.

- **Obfuscation (Mã hóa/Che giấu mã)**:

  - **Mô tả**: Mã độc được mã hóa hoặc che giấu để trông giống như dữ liệu vô hại.
  - **Mục đích**: Tránh bị phân tích bởi các công cụ bảo mật.
  - **Ví dụ**: Sử dụng base64, XOR, hoặc AES để mã hóa payload.

- **Anti-Sandboxing**:

  - **Mô tả**: Malware phát hiện môi trường sandbox (môi trường kiểm tra mã độc) và không hoạt động trong đó.
  - **Mục đích**: Tránh bị phân tích bởi các nhà nghiên cứu bảo mật.
  - **Ví dụ**: Kiểm tra phần cứng, thời gian chạy, hoặc các tiến trình đặc biệt.

- **Anti-VM (Anti-Virtual Machine)**:

  - **Mô tả**: Malware phát hiện môi trường máy ảo (VM) và không hoạt động trong đó.
  - **Mục đích**: Tránh bị phân tích trong môi trường ảo hóa.
  - **Ví dụ**: Kiểm tra các driver hoặc phần cứng đặc trưng của VM.

- **Time-Based Evasion**:

  - **Mô tả**: Malware trì hoãn hoạt động của nó trong một khoảng thời gian nhất định.
  - **Mục đích**: Tránh bị phát hiện trong quá trình kiểm tra ban đầu.
  - **Ví dụ**: Sử dụng hàm `Sleep()` để trì hoãn thực thi.

- **Process Hollowing**:

  - **Mô tả**: Malware thay thế mã của một tiến trình hợp lệ bằng mã độc.
  - **Mục đích**: Che giấu hoạt động của nó dưới một tiến trình hợp pháp.
  - **Ví dụ**: Sử dụng tiến trình `svchost.exe` để chạy mã độc.

### Ẩn mình

- **Rootkit**:

  - **Mô tả**: Malware ẩn sâu trong hệ thống, che giấu các tệp tin, tiến trình hoặc registry key của nó.
  - **Mục đích**: Tránh bị phát hiện bởi người dùng hoặc phần mềm diệt virus.
  - **Ví dụ**: Rootkit TDSS ẩn các tiến trình và tệp tin độc hại.

- **Fileless Malware**:

  - **Mô tả**: Malware không lưu trữ mã độc trên ổ đĩa mà chạy trực tiếp trong bộ nhớ RAM.
  - **Mục đích**: Tránh bị phát hiện bởi phần mềm diệt virus truyền thống.
  - **Ví dụ**: Malware Poweliks sử dụng PowerShell để thực thi mã độc.

- **Living Off the Land (LOTL)**:

  - **Mô tả**: Malware sử dụng các công cụ hợp pháp sẵn có trên hệ thống (như PowerShell, WMI, hoặc PsExec) để thực thi mã độc.
  - **Mục đích**: Tránh bị nghi ngờ vì sử dụng các công cụ hợp pháp.
  - **Ví dụ**: Sử dụng PowerShell để tải và chạy mã độc từ xa.

- **Registry Manipulation**:

  - **Mô tả**: Malware ẩn mình trong registry để khởi động cùng hệ thống.
  - **Mục đích**: Duy trì sự tồn tại lâu dài trên hệ thống.
  - **Ví dụ**: Tạo khóa registry trong `HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run`.

- **Hidden Files and Directories**:

  - **Mô tả**: Malware ẩn các tệp tin hoặc thư mục của nó bằng cách sử dụng thuộc tính ẩn hoặc kỹ thuật hệ thống.
  - **Mục đích**: Tránh bị phát hiện bởi người dùng hoặc phần mềm diệt virus.
  - **Ví dụ**: Sử dụng thuộc tính `hidden` hoặc `system` trong Windows.

- **Process Injection**:

  - **Mô tả**: Malware tiêm mã độc vào các tiến trình hợp pháp đang chạy.
  - **Mục đích**: Che giấu hoạt động của nó dưới một tiến trình hợp pháp.
  - **Ví dụ**: Tiêm mã độc vào tiến trình `explorer.exe`.

- **DNS Tunneling**:

  - **Mô tả**: Malware sử dụng các truy vấn DNS để liên lạc với máy chủ C&C (Command and Control).
  - **Mục đích**: Tránh bị phát hiện bởi tường lửa hoặc hệ thống giám sát mạng.
  - **Ví dụ**: Sử dụng các tên miền ngẫu nhiên để liên lạc.

- **Encrypted Communication**:

  - **Mô tả**: Malware mã hóa dữ liệu khi liên lạc với máy chủ C&C.
  - **Mục đích**: Tránh bị phát hiện bởi các công cụ giám sát mạng.
  - **Ví dụ**: Sử dụng HTTPS hoặc TLS để mã hóa dữ liệu.

- **User Mode Rootkits**:

  - **Mô tả**: Malware ẩn mình trong chế độ người dùng (user mode) bằng cách can thiệp vào các API của hệ điều hành.
  - **Mục đích**: Che giấu các tiến trình, tệp tin hoặc kết nối mạng.
  - **Ví dụ**: Hook các hàm API như `NtQuerySystemInformation`.

- **Kernel Mode Rootkits**:
  - **Mô tả**: Malware ẩn mình trong chế độ kernel (lõi hệ điều hành) để kiểm soát sâu hơn.
  - **Mục đích**: Che giấu hoạt động của nó khỏi các công cụ bảo mật.
  - **Ví dụ**: Rootkit ZeroAccess hoạt động ở chế độ kernel.
