---
title: CNSC - Certified Network Security Center's Intern
sidebar_position: 1
---

> ÄÃ¢y lÃ  ai, Ä‘oÃ¡n xem? \
> Má»™t chÃ ng trai nghiÃªm tÃºc, Ã­t nÃ³i, thÆ°á»ng xuáº¥t hiá»‡n vá»›i nhá»¯ng chiáº¿c Ã¡o sÆ¡ mi vÃ  quáº§n tÃ¢y trÃ´ng cÅ©ng ráº¥t lÃ  nghiÃªm tÃºc. Anh chÃ ng nÃ y lÃºc nÃ o cÅ©ng suy nghÄ© nhiá»u, lo xa, trÃ´ng lÃºc nÃ o cÅ©ng báº­n rá»™n vÃ  nhiá»u viá»‡c nhÆ°ng tháº­t sá»± thÃ¬ chá»‰ lÃ  anh chÃ ng lÃ m viá»‡c khÃ¡ cháº­m vÃ  hay lÃ m trÆ°á»›c/lÃ m thay ngÆ°á»i ta thÃ´i.\
> \
> Hmmm, ai váº­y nhá»‰? Má»i ngÆ°á»i cÃ³ Ä‘oÃ¡n ra chÆ°a?\
> ÄÃºng rá»“i, lÃ  tÃ´i/cáº­u áº¥y Ä‘Ã³ `\(>Ï‰< )/` Ehehe, má»i ngÆ°á»i cÃ²n nhá»› tÃ´i vÃ  cáº­u áº¥y hong :3 LÃ¢u quÃ¡ má»›i gáº·p láº¡i má»i ngÆ°á»i. Thá»i gian thá»±c táº­p thÃ¬ cuá»‘i tuáº§n chÃºng tÃ´i Ä‘i chá»¯a lÃ nh hoáº·c viáº¿t report Ä‘á»‹nh ká»³, nÃªn lÃ  khÃ´ng dÆ° thá»i gian Ä‘á»ƒ lÃ m blog chia sáº» Ä‘Æ°á»£c. HÃ´m nay tranh thá»§ lÃ m má»™t bÃ i ká»ƒ láº¡i quÃ¡ trÃ¬nh thá»±c táº­p cá»§a chÃºng tÃ´i nha :3

## NgÃ y Ä‘áº§u tiÃªn

> Ahaha, nghÄ© láº¡i cÅ©ng hÆ¡i máº¯c cÆ°á»i má»™t chÃºt, Ä‘Ãºng lÃ  chÃºng tÃ´i khÃ´ng bá» Ä‘Æ°á»£c tÃ­nh lo xa nÃ y mÃ . LÃºc nháº­n Ä‘Æ°á»£c mail thÃ´ng bÃ¡o Ä‘Ã£ Ä‘Æ°á»£c nháº­n thÃ¬ trong mail chá»‰ cÃ³ ngÃ y báº¯t Ä‘áº§u lÃ m viá»‡c thÃ´i, khÃ´ng cÃ³ giá» cá»¥ thá»ƒ. TÃ´i thÃ¬ tÃ­nh liÃªn há»‡ chá»‹ HR Ä‘á»ƒ há»i nhÆ°ng mÃ  cáº­u áº¥y báº£o chá»§ nháº­t rá»“i ngÆ°á»i ta khÃ´ng rep Ä‘Ã¢u, nÃªn cuá»‘i cÃ¹ng cáº£ hai khÃ´ng liÃªn láº¡c luÃ´n :v . Äáº¿n ngÃ y thá»±c táº­p Ä‘Ã³ thÃ¬ dá»±a theo giá» lÃ m viá»‡c cá»§a Trung tÃ¢m vÃ  Ä‘i sá»›m hÆ¡n gáº§n 30p, cuá»‘i cÃ¹ng thÃ¬ Ä‘á»£i tá»›i gáº§n 1 tiáº¿ng láº­n ğŸ˜‚, táº¡i giá» lÃ m viá»‡c cÅ©ng cá»§a cÃ¡c anh chá»‹ cÅ©ng khÃ´ng giá»‘ng trong thÃ´ng tin. MÃ  thÃ´i ká»‡, Ä‘áº¿n sá»›m rá»“i Ä‘á»£i chá»© ngÃ y Ä‘áº§u mÃ  Ä‘áº¿n trá»… thÃ¬ sáº½ Ä‘á»ƒ láº¡i áº¥n tÆ°á»£ng xáº¥u máº¥t! Sau Ä‘Ã³ thÃ¬ tÃ´i cÃ¹ng cáº­u áº¥y liÃªn há»‡ vá»›i anh Quáº£n lÃ½ Ä‘á»ƒ nháº­n viá»‡c, trÆ°á»›c háº¿t lÃ  dá»n chá»— Ä‘á»ƒ ngá»“i (chá»— lÃ m hiá»‡n táº¡i cá»§a Sáº¿p `(âŠ™_âŠ™;)` ), xong xuÃ´i rá»“i thÃ¬ lÃªn há»p vá»›i anh Quáº£n lÃ½ vÃ  anh Sáº¿p Ä‘á»ƒ náº¯m quy Ä‘á»‹nh, cÃ¡ch lÃ m viá»‡c vÃ  lÃ m quen vá»›i má»i ngÆ°á»i trong Trung tÃ¢m.\
> \
> Xong rá»“i thÃ¬ ... á»m, Ä‘á»£i nháº­n viá»‡c tiáº¿p :v mÃ  káº¿t quáº£ lÃ  Ä‘á»£i cáº£ buá»•i cÅ©ng chÆ°a cÃ³ gÃ¬, haha. Tháº¿ lÃ  trÆ°a má»i ngÆ°á»i á»Ÿ trung tÃ¢m má»i Ä‘i Äƒn chung Ä‘á»ƒ lÃ m quen, chÃºng tÃ´i cÅ©ng Ä‘i vÃ  ngá»“i trÃ² chuyá»‡n Ä‘Ã´i chÃºt, xong rá»“i ngá»§ trÆ°a luÃ´n. LÃºc chiá»u dáº­y, tháº¥y váº«n chÆ°a cÃ³ viá»‡c nÃªn tÃ­nh xin vá» sá»›m thÃ¬ anh Sáº¿p báº£o qua nháº­n viá»‡c `:)))` Tá»± dÆ°ng tháº¥y mÃ¬nh cÃ³ váº» lÆ°á»i biáº¿ng... Ahaha, tháº¿ rá»“i cÃ³ viá»‡c thÃ¬ lÃ m thÃ´i, Ä‘áº¿n chiá»u thÃ¬ vá» :v Tháº¿ lÃ  háº¿t ngÃ y Ä‘áº§u tiÃªn gÃ²i.

## Nhiá»‡m vá»¥ Ä‘Æ°á»£c giao vÃ  cÃ´ng viá»‡c hÃ ng ngÃ y

> Nhiá»‡m vá»¥ cá»§a tÃ´i vÃ  cáº­u áº¥y lÃ  triá»ƒn khai cÃ´ng cá»¥ Ä‘Ã¡nh giÃ¡ hiá»‡u nÄƒng K6, cÃ´ng cá»¥ giÃ¡m sÃ¡t há»‡ thá»‘ng, website cÃ³ tÃ­nh HA (High Availability) trÃªn mÃ´i trÆ°á»ng K8s (Kubernetes). Anh Sáº¿p sáº½ Ä‘Æ°a ra tá»«ng má»¥c tiÃªu nhá», cá»© má»—i cuá»‘i tuáº§n sáº½ bÃ¡o cÃ¡o cho áº£nh tiáº¿n Ä‘á»™ cÃ´ng viá»‡c, náº¿u xong rá»“i thÃ¬ áº£nh sáº½ Ä‘áº·t ra nhá»¯ng cÃ¢u há»i vá» má»¥c tiÃªu vá»«a hoÃ n thÃ nh, tá»« Ä‘Ã³ Ä‘Æ°a ra má»¥c tiÃªu tiáº¿p theo. NÃªn thÃ nh ra cáº£ quÃ¡ trÃ¬nh thá»±c táº­p má»i thá»© ráº¥t liá»n máº¡ch, cÅ©ng khÃ´ng bá»‹ Ã¡p lá»±c.\
> \
> Do Trung tÃ¢m chá»‰ yÃªu cáº§u cÃ³ máº·t 5 buá»•i/tuáº§n nÃªn thá»i gian cá»§a chÃºng tÃ´i khÃ¡ linh hoáº¡t, cÃ³ thá»ƒ Ä‘i cáº£ ngÃ y hoáº·c chá»‰ Ä‘i 1 buá»•i, tÃ¹y lá»‹ch trÃ¬nh cá»§a tuáº§n Ä‘Ã³ hoáº·c tÃ¬nh tráº¡ng sá»©c khá»e mÃ  sáº¯p xáº¿p. CÃ³ láº§n tÃ´i bá»‡nh náº±m lÃ¬ á»Ÿ kÃ½ tÃºc xÃ¡, anh Sáº¿p cho tÃ´i bÃ¡o cÃ¡o online luÃ´n. BÃ¬nh thÆ°á»ng thÃ¬ sÃ¡ng ra tÃ´i sáº½ pha cÃ  phÃª, táº­p thá»ƒ dá»¥c má»™t tÃ­ náº¿u tá»‘i qua ngá»§ Ä‘á»§ giáº¥c, náº¥u Äƒn vÃ i mÃ³n Ä‘Æ¡n giáº£n rá»“i táº¯m rá»­a sá»­a soáº¡n Ä‘á»ƒ lÃªn trung tÃ¢m, hÃ´m nÃ o thiáº¿u ngá»§ thÃ¬ ngá»§ nÆ°á»›ng má»™t chÃºt rá»“i lÃ m á»Ÿ nhÃ , tá»›i chiá»u má»›i lÃªn Trung tÃ¢m, hehe.\
> \
> Nhiá»‡m vá»¥ chÃ­nh lÃ  triá»ƒn khai nÃªn pháº§n lá»›n thá»i gian tÃ´i vÃ  cáº­u áº¥y dÃ nh thá»i gian ra tÃ¬m hiá»ƒu vá» cÃ´ng cá»¥, sáº£n pháº©m, mÃ´i trÆ°á»ng cáº§n triá»ƒn khai rá»“i Ä‘á»ƒ biáº¿t cÃ¡ch cáº¥u hÃ¬nh, tÃ¹y chá»‰nh, cÃ i Ä‘áº·t vÃ  sá»­a lá»—i, tháº­t sá»± thÃ¬ cÃ³ ráº¥t ráº¥t nhiá»u lá»—i luÃ´n. Rá»“i cÃ²n viáº¿t ká»‹ch báº£n Ä‘á»ƒ test ná»¯a, kiá»ƒm thá»­ hiá»‡u nÄƒng cá»§a website nÃªn sáº½ viáº¿t ká»‹ch báº£n mÃ´ phá»ng láº¡i hÃ nh vi cá»§a ngÆ°á»i dÃ¹ng khi truy cáº­p trang web nhÆ° truy cáº­p, Ä‘Äƒng nháº­p, xem ná»™i dung, chuyá»ƒn trang, Ä‘Äƒng xuáº¥t... Rá»“i Ä‘Æ°a ká»‹ch báº£n Ä‘Ã³ vÃ o cÃ´ng cá»¥ kiá»ƒm thá»­ K6 Ä‘á»ƒ test, xong rá»“i ghi káº¿t quáº£ vÃ o bÃ¡o cÃ¡o, náº¿u cÃ³ lá»—i thÃ¬ debug chi tiáº¿t ra Ä‘á»ƒ Ä‘Æ°a cho team Dev kháº¯c phá»¥c, bÃªn cáº¡nh Ä‘Ã³ thÃ¬ cÅ©ng pháº£i giÃ¡m sÃ¡t tÃ i nguyÃªn K8s Ä‘Æ°á»£c sá»­ dá»¥ng khi test, liá»‡u cÃ³ vÆ°á»£t quÃ¡ má»©c cho phÃ©p khÃ´ng? cÃ³ bá»‹ ngáº¯t báº¥t thÆ°á»ng khÃ´ng? cÃ³ chÃªnh lá»‡ch gÃ¬ giá»¯a cÃ¡c láº§n test khÃ´ng? Ä‘á»ƒ Ä‘áº£m báº£o cÃ´ng cá»¥ hoáº¡t Ä‘á»™ng á»•n Ä‘á»‹nh, há»‡ thá»‘ng khÃ´ng quÃ¡ táº£i.

## Káº¿t quáº£ Ä‘áº¡t Ä‘Æ°á»£c

LuyÃªn thuyÃªn nÃ£y giá» gÃ²i, giá» xem tÃ´i vÃ  cáº­u áº¥y Ä‘Ã£ lÃ m Ä‘Æ°á»£c nhá»¯ng gÃ¬ nÃ o?

![system](./img/system.png)

### Kiáº¿n thá»©c vá» K8s

> Tháº­t sá»± thÃ¬ Ä‘Ã¢y lÃ  láº§n Ä‘áº§u tiÃªn tÃ´i vÃ  cáº­u áº¥y sá»­ dá»¥ng ná»n táº£ng quáº£n lÃ½ container K8s nÃ y, lÃºc trÆ°á»›c cÃ³ biáº¿t nhÆ°ng chÆ°a cÃ³ dá»‹p Ä‘á»ƒ dÃ¹ng :v CÃ²n sá»­ dá»¥ng Docker image thÃ¬ cÅ©ng cÃ³ nhÆ°ng cÅ©ng chÆ°a tÃ¬m hiá»ƒu sÃ¢u láº¯m. NÃªn lÃºc Ä‘áº§u thá»±c táº­p tÃ´i vÃ  cáº­u áº¥y pháº£i máº¥t vÃ i ngÃ y Ä‘á»ƒ tÃ¬m hiá»ƒu vÃ  lÃ m quen vá»›i cÃ¡c khÃ¡i niá»‡m trong ná»n táº£ng nÃ y. Giá» thÃ¬ náº¯m Ä‘Æ°á»£c kha khÃ¡ cÃ¡c thÃ nh pháº§n, cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a K8s rá»“i :3 Äiá»ƒm máº¡nh cá»§a K8s thÃ¬ cháº¯c cháº¯n pháº£i ká»ƒ Ä‘áº¿n kháº£ nÄƒng má»Ÿ rá»™ng (scalable) dá»±a trÃªn má»©c sá»­ dá»¥ng cá»§a á»©ng dá»¥ng Ä‘Æ°á»£c triá»ƒn khai Ä‘á»ƒ tá»‘i Æ°u tÃ i nguyÃªn rá»“i. CÅ©ng cÃ³ thá»ƒ ká»ƒ Ä‘áº¿n viá»‡c phÃ¢n quyá»n dá»±a trÃªn vai trÃ² (RBAC) cá»§a K8s giÃºp Ä‘áº£m báº£o nguyÃªn táº¯c vá» quyá»n tá»‘i thiá»ƒu, giáº£m thiá»ƒu rá»§i ro báº£o máº­t ná»¯a :3 \
> \  
> Ã€ mÃ , tÃ´i vÃ  cáº­u áº¥y lÃ  Cluster Owner - vai trÃ² cao nháº¥t trong K8s nha, cÃ²n lÃ½ do thÃ¬ tÃ­ ná»¯a tÃ´i sáº½ ká»ƒ á»Ÿ pháº§n [KhÃ³ khÄƒn vÃ  cÃ¡ch giáº£i quyáº¿t](#khÃ³-khÄƒn-vÃ -cÃ¡ch-giáº£i-quyáº¿t), hehe.

---

### CÃ´ng cá»¥ kiá»ƒm thá»­ hiá»‡u nÄƒng

#### Testkube

> ÄÃ¢y lÃ  má»¥c tiÃªu lÃºc Ä‘áº§u cá»§a tÃ´i Ä‘Æ°á»£c giao Ä‘á»ƒ tÃ¬m hiá»ƒu vÃ  triá»ƒn khai Ã¡, cÆ¡ mÃ  do cÃ²n nhiá»u lá»—i vÃ¬ lÃ  cÃ´ng cá»¥ má»›i vÃ  khÃ´ng phÃ¹ há»£p má»¥c Ä‘Ã­ch triá»ƒn khai nÃªn Ä‘Ã£ bá»‹ loáº¡i bá» rá»“i. Hi vá»ng lÃ  sau nÃ y cÃ´ng cá»¥ sáº½ Ä‘Æ°á»£c cáº£i tiáº¿n thÃªm :>

![Testkube architecture](./img/Testkube_architecture.png)

Testkube lÃ  má»™t framework kiá»ƒm thá»­ mÃ£ nguá»“n má»Ÿ Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ tÃ­ch há»£p trá»±c tiáº¿p vá»›i Kubernetes, cho phÃ©p tá»± Ä‘á»™ng hÃ³a viá»‡c thá»±c thi cÃ¡c bÃ i kiá»ƒm thá»­ trong mÃ´i trÆ°á»ng Cloud-Native.

![testkube version](./img/testkube_version.png)

**Má»™t sá»‘ kháº£ nÄƒng ná»•i báº­t cá»§a Testkube:**

- Tá»± Ä‘á»™ng hÃ³a kiá»ƒm thá»­: Testkube cho phÃ©p Ä‘á»‹nh nghÄ©a cÃ¡c bÃ i kiá»ƒm thá»­ dÆ°á»›i dáº¡ng tÃ i nguyÃªn tÃ¹y chá»‰nh (Custom Resources - CRD) cá»§a Kubernetes, giÃºp tÃ­ch há»£p kiá»ƒm thá»­ má»™t cÃ¡ch tá»± nhiÃªn vÃ o cá»¥m K8s.
- Há»— trá»£ Ä‘a dáº¡ng cÃ´ng cá»¥: Testkube cÃ³ má»™t há»‡ sinh thÃ¡i cÃ¡c Executor há»— trá»£ nhiá»u cÃ´ng cá»¥ kiá»ƒm thá»­ phá»• biáº¿n nhÆ° k6, Cypress, Playwright, JMeter, Postman, vÃ  SoapUI. Äiá»u nÃ y giÃºp dá»… dÃ ng sá»­ dá»¥ng cÃ¡c cÃ´ng cá»¥ cáº§n thiáº¿t mÃ  khÃ´ng cáº§n thay Ä‘á»•i quy trÃ¬nh.
- TÃ­ch há»£p CI/CD: Testkube dá»… dÃ ng káº¿t ná»‘i vá»›i cÃ¡c cÃ´ng cá»¥ CI/CD truyá»n thá»‘ng nhÆ° GitHub Actions, GitLab CI, vÃ  Jenkins, cho phÃ©p kÃ­ch hoáº¡t cÃ¡c bÃ i kiá»ƒm thá»­ nhÆ° má»™t pháº§n cá»§a quy trÃ¬nh triá»ƒn khai á»©ng dá»¥ng.
- Báº£o máº­t: CÃ¡c bÃ i kiá»ƒm thá»­ Ä‘Æ°á»£c cháº¡y bÃªn trong cÃ¡c Pod riÃªng biá»‡t, giÃºp cÃ¡ch ly chÃºng khá»i cÃ¡c á»©ng dá»¥ng chÃ­nh. Giao tiáº¿p giá»¯a cÃ¡c thÃ nh pháº§n Ä‘Æ°á»£c mÃ£ hÃ³a báº±ng TLS, vÃ  viá»‡c kiá»ƒm soÃ¡t truy cáº­p Ä‘Æ°á»£c thá»±c hiá»‡n thÃ´ng qua RBAC (Role-Based Access Control).
- Quáº£n lÃ½ táº­p trung: Testkube cung cáº¥p má»™t Dashboard trá»±c quan cho phÃ©p quáº£n lÃ½, theo dÃµi vÃ  phÃ¢n tÃ­ch káº¿t quáº£ kiá»ƒm thá»­ má»™t cÃ¡ch dá»… dÃ ng.
- Kháº£ nÄƒng má»Ÿ rá»™ng: Báº±ng cÃ¡ch táº­n dá»¥ng kháº£ nÄƒng cá»§a Kubernetes, Testkube cÃ³ thá»ƒ cháº¡y cÃ¡c bÃ i kiá»ƒm thá»­ á»Ÿ quy mÃ´ lá»›n, há»— trá»£ cáº£ kiá»ƒm thá»­ táº£i (load testing) vÃ  kiá»ƒm thá»­ chá»©c nÄƒng (functional testing).

**Luá»“ng hoáº¡t Ä‘á»™ng:**

- Äá»‹nh nghÄ©a bÃ i test báº±ng YAML hoáº·c thÃ´ng qua Dashboard.
- Agent khá»Ÿi táº¡o Pods test trong cá»¥m K8s, cháº¡y cÃ´ng cá»¥ kiá»ƒm thá»­ (vÃ­ dá»¥: k6).
- Logs, artifact, káº¿t quáº£ Ä‘Æ°á»£c tráº£ vá» vÃ  hiá»ƒn thá»‹ qua Dashboard.

![testkube result test](./img/testkube_result_test.png)

**Æ¯u Ä‘iá»ƒm:** Giáº£m phá»¥ thuá»™c vÃ o CI/CD pipeline, há»— trá»£ Ä‘a cá»¥m, scale tá»‘t.

**NhÆ°á»£c Ä‘iá»ƒm:** Há»‡ sinh thÃ¡i cÃ²n má»›i, má»™t sá»‘ tÃ­nh nÄƒng (vÃ­ dá»¥ xuáº¥t dá»¯ liá»‡u tá»« distributed worker sang InfluxDB) chÆ°a thá»±c sá»± á»•n Ä‘á»‹nh.

#### K6

> ÄÃ¢y lÃ  cÃ´ng cá»¥ chÃ­nh Ä‘Æ°á»£c sá»­ dá»¥ng xuyÃªn suá»‘t trong quÃ¡ trÃ¬nh thá»±c táº­p cá»§a chÃºng tÃ´i nÃ¨ :> Ban Ä‘áº§u thÃ¬ tÃ´i vÃ  cáº­u áº¥y khÃ´ng tÃ¬m hiá»ƒu nhiá»u vá» cÃ´ng cá»¥ nÃ y, chá»‰ cÃ³ viáº¿t ká»‹ch báº£n Ä‘á»ƒ test thÃ´i, vá» sau khi cáº§n táº­n dá»¥ng tÃ­nh nÄƒng phÃ¢n phá»‘i kiá»ƒm thá»­ tá»± Ä‘á»™ng thÃ¬ má»›i tÃ¬m hiá»ƒu ká»¹.

![k6 run test](./img/k6_run_test.png)

Grafana K6 lÃ  má»™t cÃ´ng cá»¥ mÃ£ nguá»“n má»Ÿ (open-source) Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ thá»±c hiá»‡n kiá»ƒm thá»­ hiá»‡u nÄƒng (performance testing) vÃ  kiá»ƒm thá»­ táº£i (load testing) cho cÃ¡c á»©ng dá»¥ng, Ä‘áº·c biá»‡t lÃ  cÃ¡c API, website, vÃ  há»‡ thá»‘ng microservices, há»— trá»£ viáº¿t ká»‹ch báº£n báº±ng JavaScript, Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ dá»… sá»­ dá»¥ng, tá»± Ä‘á»™ng hÃ³a vÃ  tÃ­ch há»£p vá»›i cÃ¡c há»‡ thá»‘ng DevOps/CI/CD trong mÃ´i trÆ°á»ng Cloud-Native.

**Má»¥c Ä‘Ã­ch:**

- Kiá»ƒm thá»­ táº£i vÃ  hiá»‡u nÄƒng: k6 Ä‘Æ°á»£c tá»‘i Æ°u Ä‘á»ƒ tiÃªu tá»‘n Ã­t tÃ i nguyÃªn, phÃ¹ há»£p cho cÃ¡c bÃ i kiá»ƒm thá»­ táº£i náº·ng nhÆ° spike, stress, hoáº·c soak test.
- Kiá»ƒm thá»­ hiá»‡u nÄƒng trÃ¬nh duyá»‡t: Qua API trÃ¬nh duyá»‡t cá»§a k6, cÃ³ thá»ƒ kiá»ƒm thá»­ hiá»‡u nÄƒng dá»±a trÃªn trÃ¬nh duyá»‡t, thu tháº­p sá»‘ liá»‡u vÃ  káº¿t há»£p vá»›i cÃ¡c bÃ i test khÃ¡c Ä‘á»ƒ cÃ³ cÃ¡i nhÃ¬n toÃ n diá»‡n.
- GiÃ¡m sÃ¡t hiá»‡u nÄƒng vÃ  kiá»ƒm thá»­ Ä‘á»‹nh ká»³: CÃ³ thá»ƒ lÃªn lá»‹ch cháº¡y cÃ¡c bÃ i test nháº¹ thÆ°á»ng xuyÃªn Ä‘á»ƒ theo dÃµi hiá»‡u nÄƒng há»‡ thá»‘ng sáº£n xuáº¥t. CÃ³ thá»ƒ tÃ­ch há»£p vá»›i Grafana Cloud Ä‘á»ƒ giÃ¡m sÃ¡t tá»•ng há»£p.
- Tá»± Ä‘á»™ng hÃ³a kiá»ƒm thá»­ hiá»‡u nÄƒng: k6 tÃ­ch há»£p tá»‘t vá»›i CI/CD, giÃºp Dev tá»± Ä‘á»™ng hÃ³a kiá»ƒm thá»­ trong quy trÃ¬nh phÃ¡t triá»ƒn vÃ  triá»ƒn khai pháº§n má»m.
- Kiá»ƒm thá»­ Ä‘á»™ chá»‹u lá»—i vÃ  há»—n loáº¡n: CÃ³ thá»ƒ mÃ´ phá»ng lÆ°u lÆ°á»£ng hoáº·c gÃ¢y lá»—i trong há»‡ thá»‘ng (nhÆ° Kubernetes) thÃ´ng qua cÃ´ng cá»¥ xk6-disruptor Ä‘á»ƒ kiá»ƒm tra kháº£ nÄƒng phá»¥c há»“i.
- Kiá»ƒm thá»­ háº¡ táº§ng: Vá»›i cÃ¡c tiá»‡n Ã­ch má»Ÿ rá»™ng, k6 há»— trá»£ thÃªm giao thá»©c má»›i hoáº·c kiá»ƒm thá»­ trá»±c tiáº¿p cÃ¡c thÃ nh pháº§n cá»¥ thá»ƒ trong háº¡ táº§ng.

**CÃ¡c loáº¡i test:**

| Loáº¡i Test                      | Má»¥c tiÃªu                                                                              | Äáº·c Ä‘iá»ƒm                                                                                                           |
| ------------------------------ | ------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------ |
| **Smoke Test**                 | Kiá»ƒm tra nhanh há»‡ thá»‘ng cÃ³ hoáº¡t Ä‘á»™ng cÆ¡ báº£n khÃ´ng trÆ°á»›c khi cháº¡y test lá»›n hÆ¡n.        | - Táº£i tháº¥p, thá»i gian ngáº¯n (vÃ i giÃ¢y Ä‘áº¿n vÃ i phÃºt).- 1â€“10 VUs, gá»­i vÃ i request Ä‘á»ƒ xem server pháº£n há»“i á»•n khÃ´ng.    |
| **Load Test (Ramping)**        | XÃ¡c Ä‘á»‹nh hiá»‡u nÄƒng há»‡ thá»‘ng trong Ä‘iá»u kiá»‡n táº£i trung bÃ¬nh hoáº·c dá»± kiáº¿n.              | - TÄƒng dáº§n sá»‘ VUs Ä‘áº¿n má»©c á»•n Ä‘á»‹nh.- Äo thá»i gian pháº£n há»“i, sá»‘ lá»—i, throughput.                                     |
| **Stress Test**                | TÃ¬m ngÆ°á»¡ng tá»‘i Ä‘a chá»‹u táº£i vÃ  pháº£n á»©ng khi quÃ¡ táº£i.                                   | - TÄƒng táº£i liÃªn tá»¥c Ä‘áº¿n khi há»‡ thá»‘ng cháº­m/há»ng.- XÃ¡c Ä‘á»‹nh bottlenecks.                                             |
| **Spike Test**                 | Kiá»ƒm tra pháº£n á»©ng há»‡ thá»‘ng khi tÄƒng táº£i Ä‘á»™t ngá»™t.                                     | - TÄƒng Ä‘á»™t biáº¿n sá»‘ VUs rá»“i giáº£m ngay.- Kiá»ƒm tra elastic scaling hoáº·c crash behavior.                               |
| **Soak Test (Endurance Test)** | Kiá»ƒm tra Ä‘á»™ á»•n Ä‘á»‹nh lÃ¢u dÃ i dÆ°á»›i táº£i vá»«a pháº£i.                                        | - Cháº¡y nhiá»u giá» Ä‘áº¿n vÃ i ngÃ y.- TÃ¬m rÃ² rá»‰ bá»™ nhá»›, lá»—i tÃ­ch lÅ©y, suy giáº£m hiá»‡u suáº¥t.                                |
| **Breakpoint Test**            | XÃ¡c Ä‘á»‹nh má»©c táº£i chÃ­nh xÃ¡c khi há»‡ thá»‘ng báº¯t Ä‘áº§u fail (giá»¯a load test vÃ  stress test). | - TÄƒng táº£i tá»«ng bÆ°á»›c nhá».- Quan sÃ¡t má»©c suy giáº£m hiá»‡u nÄƒng.                                                        |
| **Capacity Test**              | TÃ¬m ngÆ°á»¡ng ngÆ°á»i dÃ¹ng tá»‘i Ä‘a mÃ  há»‡ thá»‘ng váº«n Ä‘Ã¡p á»©ng hiá»‡u nÄƒng cháº¥p nháº­n Ä‘Æ°á»£c.        | - Táº­p trung má»‘i quan há»‡ giá»¯a VUs vÃ  Ä‘á»™ trá»…/há»ng.- CÃ³ thá»ƒ Ä‘áº·t threshold, vÃ­ dá»¥: http_req_duration: ['p(95) < 500']. |

**CÃ¡c loáº¡i executor:**

| Executor                  | Hoáº¡t Ä‘á»™ng                                                                      | Chá»©c nÄƒng                                                      | Tham sá»‘ báº¯t buá»™c                                                    |
| ------------------------- | ------------------------------------------------------------------------------ | -------------------------------------------------------------- | ------------------------------------------------------------------- |
| **shared-iterations**     | CÃ¡c VUs chia nhau thá»±c hiá»‡n má»™t sá»‘ lÆ°á»£ng iteration cá»‘ Ä‘á»‹nh.                    | Cháº¡y má»™t sá»‘ láº§n nháº¥t Ä‘á»‹nh, khÃ´ng quan trá»ng thá»i gian.         | `iterations`                                                        |
| **per-vu-iterations**     | Má»—i VU thá»±c hiá»‡n sá»‘ láº§n iteration riÃªng biá»‡t.                                  | MÃ´ phá»ng ngÆ°á»i dÃ¹ng cÃ³ hÃ nh vi cá»‘ Ä‘á»‹nh.                        | `iterations, vus`                                                   |
| **constant-vus**          | Sá»‘ VU cá»‘ Ä‘á»‹nh cháº¡y liÃªn tá»¥c trong khoáº£ng thá»i gian xÃ¡c Ä‘á»‹nh.                   | Giá»¯ táº£i á»•n Ä‘á»‹nh Ä‘á»ƒ Ä‘o performance.                             | `vus, duration`                                                     |
| **ramping-vus**           | TÄƒng/giáº£m sá»‘ VU theo thá»i gian.                                                | MÃ´ phá»ng má»©c táº£i tÄƒng dáº§n hoáº·c giáº£m dáº§n.                       | `stages: [{ duration, target }]`                                    |
| **constant-arrival-rate** | Gá»­i sá»‘ request (iterations) cá»‘ Ä‘á»‹nh trong má»—i Ä‘Æ¡n vá»‹ thá»i gian, báº¥t ká»ƒ sá»‘ VUs. | MÃ´ phá»ng há»‡ thá»‘ng theo sá»‘ request/giÃ¢y (RPS).                  | `rate, duration, preAllocatedVUs, maxVUs`                           |
| **ramping-arrival-rate**  | Táº¡o sá»‘ lÆ°á»£ng iteration thay Ä‘á»•i theo thá»i gian.                                | MÃ´ phá»ng sá»‘ request/giÃ¢y tÄƒng/giáº£m theo thá»i gian.             | `stages: [{ duration, target }], duration, preAllocatedVUs, maxVUs` |
| **externally-controlled** | Äiá»u khiá»ƒn test tá»« bÃªn ngoÃ i (API, k6 Operator, Testkubeâ€¦).                    | TÃ­ch há»£p vÃ o cÃ¡c há»‡ thá»‘ng test Ä‘á»™ng nhÆ° CI/CD hoáº·c Kubernetes. | â€”                                                                   |

---

### CÃ´ng cá»¥ giÃ¡m sÃ¡t

#### Grafana

> CÃ³ thá»ƒ nÃ³i ngáº¯n gá»n lÃ  nÆ¡i hiá»ƒn thá»‹ táº¥t cáº£ cÃ¡c dá»¯ liá»‡u thu tháº­p Ä‘Æ°á»£c thÃ nh cÃ¡c báº£ng Ä‘iá»u khiá»ƒn/giÃ¡m sÃ¡t (Dashboard) :v

Cá»¥ thá»ƒ thÃ¬ Grafana lÃ  má»™t ná»n táº£ng mÃ£ nguá»“n má»Ÿ chuyÃªn dÃ¹ng Ä‘á»ƒ phÃ¢n tÃ­ch vÃ  trá»±c quan hÃ³a dá»¯ liá»‡u. NÃ³ káº¿t ná»‘i vá»›i cÃ¡c nguá»“n dá»¯ liá»‡u khÃ¡c nhau, cháº³ng háº¡n nhÆ° InflluxDB, Prometheus vÃ  Loki, Ä‘á»ƒ táº¡o ra cÃ¡c dashboard tÃ¹y chá»‰nh. Trong quÃ¡ trÃ¬nh thá»±c táº­p thÃ¬ Grafana Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ hiá»ƒn thá»‹ quÃ¡ trÃ¬nh kiá»ƒm thá»­ hiá»‡u nÄƒng cá»§a k6, tÃ i nguyÃªn cá»§a Pods, Workers cÅ©ng nhÆ° Nodes theo thá»i gian thá»±c, giÃºp dá»… dÃ ng theo dÃµi táº£i cá»§a há»‡ thá»‘ng trong quÃ¡ trÃ¬nh kiá»ƒm thá»­ cÅ©ng nhÆ° log cá»§a cÃ¡c Ä‘á»‘i tÆ°á»£ng trong Cluster thu tháº­p bá»Ÿi Loki, há»— trá»£ phÃ¢n tÃ­ch sÃ¢u khi cÃ³ lá»—i.

![Grafana home](./img/Grafana_home.png)
_Trang home cá»§a Grafana nÃ¨_

![Grafana dasboard](./img/Grafana_dasboard.png)
_Dashboard giÃ¡m sÃ¡t CPU, Memory cÃ¡c Node trong Cluster_

![Grafana dashboard 2](./img/Grafana_dasboard_2.png)
_Dashboard giÃ¡m sÃ¡t kiá»ƒm thá»­ hiá»‡u nÄƒng K6_

#### Prometheus

![Prometheus archi](./img/Prometheus_archi.png)

LÃ  má»™t há»‡ thá»‘ng giÃ¡m sÃ¡t vÃ  cáº£nh bÃ¡o mÃ£ nguá»“n má»Ÿ. NÃ³ Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ thu tháº­p cÃ¡c chá»‰ sá»‘ (metrics) theo thá»i gian thá»±c tá»« cÃ¡c há»‡ thá»‘ng Ä‘Æ°á»£c giÃ¡m sÃ¡t. á» Ä‘áº§y thÃ¬ Prometheus Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thu tháº­p cÃ¡c chá»‰ sá»‘ hiá»‡u nÄƒng cá»§a cÃ¡c thÃ nh pháº§n há»‡ thá»‘ng nhÆ° CPU, memory, cÅ©ng nhÆ° cÃ¡c chá»‰ sá»‘ tá»« cÃ¡c bÃ i kiá»ƒm thá»­ K6 (giai Ä‘oáº¡n Ä‘áº§u, sau nÃ y khÃ´ng dÃ¹ng ná»¯a).

#### Loki

![Loki archi](./img/Loki_archi.png)

LÃ  má»™t há»‡ thá»‘ng tá»•ng há»£p log (log aggregation) hoáº¡t Ä‘á»™ng giá»‘ng nhÆ° Prometheus, nhÆ°ng Ä‘Æ°á»£c tá»‘i Æ°u hÃ³a cho log thay vÃ¬ metrics. NÃ³ giÃºp thu tháº­p, lÆ°u trá»¯ vÃ  truy váº¥n cÃ¡c log tá»« cÃ¡c á»©ng dá»¥ng Ä‘ang cháº¡y trong cá»¥m Kubernetes. Sá»­ dá»¥ng Loki káº¿t há»£p vá»›i Grafana cÃ³ thá»ƒ dá»… dÃ ng tÃ¬m kiáº¿m vÃ  phÃ¢n tÃ­ch log Ä‘á»ƒ phÃ¡t hiá»‡n vÃ  kháº¯c phá»¥c cÃ¡c váº¥n Ä‘á».

Loki cÃ³ kiáº¿n trÃºc phÃ¢n tÃ¡n vÃ  Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ má»Ÿ rá»™ng má»™t cÃ¡ch linh hoáº¡t, thÃ nh pháº§n gá»“m:

- **Distributor:** Nháº­n log tá»« cÃ¡c agent (vÃ­ dá»¥: Promtail, Fluentd, Fluentbit, Logstashâ€¦). Thá»±c hiá»‡n viá»‡c xÃ¡c thá»±c (authentication), gáº¯n nhÃ£n (labels) vÃ  phÃ¢n phá»‘i dá»¯ liá»‡u Ä‘áº¿n cÃ¡c Ingester.
- **Ingester:** Nháº­n log tá»« Distributor, chia dá»¯ liá»‡u thÃ nh chunks (khá»‘i dá»¯ liá»‡u nÃ©n) Ä‘á»ƒ tá»‘i Æ°u dung lÆ°á»£ng. LÆ°u táº¡m trong bá»™ nhá»› RAM vÃ  sau Ä‘Ã³ flush ra Object Store (S3, GCS, MinIOâ€¦) theo tá»«ng batch.
- **Query Frontend:** Tiáº¿p nháº­n truy váº¥n tá»« ngÆ°á»i dÃ¹ng (Grafana, API). Thá»±c hiá»‡n query splitting vÃ  parallelization: chia nhá» truy váº¥n Ä‘á»ƒ gá»­i Ä‘áº¿n nhiá»u Querier, tÄƒng tá»‘c Ä‘á»™ xá»­ lÃ½, káº¿t há»£p caching káº¿t quáº£ Ä‘á»ƒ giáº£m táº£i há»‡ thá»‘ng.
- **Querier:** Nháº­n yÃªu cáº§u tá»« Query Frontend vÃ  truy xuáº¥t dá»¯ liá»‡u tá»« Ingester (dá»¯ liá»‡u má»›i, chÆ°a flush ra object store) hoáº·c Object Store (S3/MinIO â€“ dá»¯ liá»‡u lÆ°u trá»¯ lÃ¢u dÃ i), tá»•ng há»£p káº¿t quáº£ rá»“i tráº£ vá» Query Frontend Ä‘á»ƒ hiá»ƒn thá»‹.
- **Ruler:** Thá»±c hiá»‡n cÃ¡c alerting rules vÃ  recording rules tÆ°Æ¡ng tá»± nhÆ° Prometheus. VÃ­ dá»¥: tá»± Ä‘á»™ng phÃ¡t hiá»‡n lá»—i báº±ng cÃ¡ch viáº¿t query Ä‘á»ƒ cáº£nh bÃ¡o khi táº§n suáº¥t log error vÆ°á»£t ngÆ°á»¡ng.
- **Objec Storage:** lÆ°u trá»¯ dá»¯ liá»‡u lÃ¢u dÃ i, cÃ³ 2 Ä‘á»‹nh dáº¡ng chÃ­nh Ä‘Æ°á»£c lÆ°u:
- **Index (chá»‰ má»¥c):** LÆ°u thÃ´ng tin metadata (labels, stream ID, timestamp). GiÃºp há»‡ thá»‘ng biáº¿t cáº§n tÃ¬m dá»¯ liá»‡u á»Ÿ Ä‘Ã¢u trong cÃ¡c chunk. LÆ°u trong Object Store (S3/MinIO) hoáº·c cÆ¡ sá»Ÿ dá»¯ liá»‡u nhÆ° DynamoDB, BigTable, hoáº·c BoltDB-shipper.
- **Chunks (khá»‘i dá»¯ liá»‡u):** Chá»©a dá»¯ liá»‡u log Ä‘Ã£ Ä‘Æ°á»£c nÃ©n (snappy/gzip). ÄÆ°á»£c flush tá»« Ingester ra Object Store. Má»—i chunk thÆ°á»ng cÃ³ kÃ­ch thÆ°á»›c ~1â€“2MB, giÃºp tá»‘i Æ°u I/O vÃ  chi phÃ­.

**Khi cÃ³ truy váº¥n:**

- Querier tra cá»©u Index Ä‘á»ƒ biáº¿t chunk nÃ o cáº§n Ä‘á»c.
- Láº¥y chunk tá»« Object Store.
- Giáº£i nÃ©n, lá»c log theo query.
- Tráº£ káº¿t quáº£ vá» Query Frontend vÃ  hiá»ƒn thá»‹ lÃªn Grafana.

---

### CÃ´ng cá»¥ há»— trá»£ khÃ¡c

#### InfluxDB

InfluxDB lÃ  má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u time-series mÃ£ nguá»“n má»Ÿ, Ä‘Æ°á»£c tá»‘i Æ°u Ä‘á»ƒ lÆ°u trá»¯ vÃ  truy váº¥n dá»¯ liá»‡u theo thá»i gian. TrÃªn Kubernetes, InfluxDB thÆ°á»ng Ä‘Æ°á»£c triá»ƒn khai cÃ¹ng vá»›i Telegraf Ä‘á»ƒ thu tháº­p vÃ  lÆ°u trá»¯ cÃ¡c metrics há»‡ thá»‘ng, á»©ng dá»¥ng, vÃ  logs. Trong há»‡ thá»‘ng, InfluxDB Ä‘Æ°á»£c sá»­ dá»¥ng lÃ m nÆ¡i lÆ°u trá»¯ dá»¯ liá»‡u kiá»ƒm thá»­ hiá»‡u nÄƒng tá»« k6, giÃºp truy váº¥n vÃ  phÃ¢n tÃ­ch dá»¯ liá»‡u má»™t cÃ¡ch hiá»‡u quáº£.

#### Kafka

> á» Ä‘Ã¢y thÃ¬ chÃºng tÃ´i cÃ i Ä‘áº·t vÃ  cáº¥u hÃ¬nh Kafka Queue á»Ÿ trÆ°á»›c InfluxDB nha :v, vÃ¬ khi kiá»ƒm thá»­ hiá»‡u nÄƒng lá»›n, viá»‡c cháº¡y test Ä‘Æ°á»£c chia thÃ nh nhiá»u pod worker nhá» cháº¡y song song, lÃºc nÃ y dá»¯ liá»‡u kiá»ƒm thá»­ Ä‘Æ°á»£c gá»­i Ä‘áº¿n InfluxDB lÃ  ráº¥t lá»›n, khiáº¿n cho InfluxDB khÃ´ng thá»ƒ xá»­ lÃ½ háº¿t vÃ  hiá»ƒn thá»‹ sai, thiáº¿u dá»¯ liá»‡u tháº­m chÃ­ lÃ  ngá»«ng hoáº¡t Ä‘á»™ng. Tháº¿ nÃªn Ä‘áº·t má»™t hÃ ng Ä‘á»£i lÃ  Kafka trÆ°á»›c InfluxDB Ä‘á»ƒ Ä‘áº£m báº£o dá»¯ liá»‡u khÃ´ng bá»‹ gá»­i á»“ áº¡t, khÃ´ng bá»‹ sÃ³t hay máº¥t dá»¯ liá»‡u :>

Kafka lÃ  má»™t ná»n táº£ng streaming phÃ¢n tÃ¡n mÃ£ nguá»“n má»Ÿ, chuyÃªn dÃ¹ng Ä‘á»ƒ xá»­ lÃ½ luá»“ng dá»¯ liá»‡u theo thá»i gian thá»±c. Khi triá»ƒn khai trÃªn Kubernetes (thÆ°á»ng qua Strimzi Operator), Kafka hoáº¡t Ä‘á»™ng nhÆ° má»™t message broker trung gian, cho phÃ©p gá»­i vÃ  nháº­n dá»¯ liá»‡u theo mÃ´ hÃ¬nh publish/subscribe. Trong há»‡ thá»‘ng, Kafka Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ truyá»n cÃ¡c metrics vÃ  logs tá»« k6 Ä‘áº¿n há»‡ thá»‘ng thu tháº­p dá»¯ liá»‡u, Ä‘áº£m báº£o kháº£ nÄƒng xá»­ lÃ½ dá»¯ liá»‡u lá»›n, theo thá»i gian thá»±c vÃ  má»Ÿ rá»™ng dá»… dÃ ng.

![Kafka archi](./img/Kafka_archi.png)

**Cáº¥u trÃºc cá»§a Apache Kafka:**

- **Producer:** ThÃ nh pháº§n gá»­i (publish) dá»¯ liá»‡u Ä‘áº¿n Kafka. Dá»¯ liá»‡u Ä‘Æ°á»£c ghi vÃ o topic.
- **Topic & Partition:**
  - Topic: kÃªnh (channel) nÆ¡i dá»¯ liá»‡u Ä‘Æ°á»£c phÃ¢n loáº¡i.
  - Partition: má»—i topic chia thÃ nh nhiá»u phÃ¢n vÃ¹ng Ä‘á»ƒ tÄƒng kháº£ nÄƒng song song vÃ  má»Ÿ rá»™ng.
  - Má»—i partition lÃ  má»™t log (append-only), cÃ¡c báº£n ghi Ä‘Æ°á»£c gáº¯n offset.
- **Broker:** MÃ¡y chá»§ Kafka, lÆ°u trá»¯ dá»¯ liá»‡u vÃ  xá»­ lÃ½ cÃ¡c request tá»« producer/consumer. Má»™t cluster Kafka cÃ³ nhiá»u broker Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh má»Ÿ rá»™ng vÃ  dá»± phÃ²ng.
- **Zookeeper** (trong Kafka 1.x â€“ 2.x): Quáº£n lÃ½ metadata, leader election cho partition. Tá»« Kafka 3.x trá»Ÿ Ä‘i, Zookeeper dáº§n Ä‘Æ°á»£c thay tháº¿ bá»Ÿi KRaft (Kafka Raft Metadata mode) â€“ kiáº¿n trÃºc má»›i loáº¡i bá» sá»± phá»¥ thuá»™c vÃ o Zookeeper.
- **Consumer & Consumer Group:**
  - Consumer: Ä‘á»c dá»¯ liá»‡u tá»« topic/partition.
  - Consumer group: nhÃ³m consumer chia nhau xá»­ lÃ½ dá»¯ liá»‡u tá»« má»™t topic. Má»—i partition chá»‰ Ä‘Æ°á»£c xá»­ lÃ½ bá»Ÿi má»™t consumer trong group â†’ giÃºp cÃ¢n báº±ng táº£i.
- **Replication:**
  - Má»—i partition cÃ³ thá»ƒ cÃ³ nhiá»u báº£n sao (replica).
  - Má»™t replica Ä‘Æ°á»£c chá»n lÃ m leader, cÃ²n láº¡i lÃ  follower Ä‘á»ƒ dá»± phÃ²ng.
  - Náº¿u leader há»ng, má»™t follower Ä‘Æ°á»£c báº§u lÃªn lÃ m leader má»›i.

#### Telegraf

Telegraf lÃ  má»™t agent thu tháº­p dá»¯ liá»‡u mÃ£ nguá»“n má»Ÿ do InfluxData phÃ¡t triá»ƒn. NÃ³ cÃ³ kiáº¿n trÃºc dá»±a trÃªn plugin, há»— trá»£ thu tháº­p metrics tá»« há»‡ thá»‘ng, á»©ng dá»¥ng, container, vÃ  Kubernetes. Telegraf cÃ³ thá»ƒ cháº¡y dÆ°á»›i dáº¡ng DaemonSet hoáº·c sidecar trÃªn cluster Ä‘á»ƒ tá»± Ä‘á»™ng thu tháº­p thÃ´ng tin. Trong há»‡ thá»‘ng nÃ y, Telegraf Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ láº¥y metrics tá»« Kafka, Kubernetes vÃ  cÃ¡c thÃ nh pháº§n khÃ¡c, sau Ä‘Ã³ Ä‘áº©y vÃ o InfluxDB Ä‘á»ƒ phá»¥c vá»¥ viá»‡c lÆ°u trá»¯ vÃ  phÃ¢n tÃ­ch.

---

### Quáº£n lÃ½ lÆ°u trá»¯

#### Longhorn

![Longhorn archi](./img/Longhorn_archi.png)

Longhorn lÃ  má»™t giáº£i phÃ¡p lÆ°u trá»¯ phÃ¢n tÃ¡n mÃ£ nguá»“n má»Ÿ, Ä‘Æ°á»£c phÃ¡t triá»ƒn bá»Ÿi Rancher. Longhorn cung cáº¥p Persistent Volume vá»›i dung lÆ°á»£ng tÃ¹y chá»‰nh Ä‘á»ƒ lÆ°u trá»¯ bá»n vá»¯ng vÃ  chá»‹u lá»—i cao báº±ng cÃ¡ch sao chÃ©p dá»¯ liá»‡u trÃªn nhiá»u node (lÆ°u Ã½ nhÃ©). NÃ³ sá»­ dá»¥ng cÃ´ng nghá»‡ iSCSI Ä‘á»ƒ táº¡o cÃ¡c volume, cho phÃ©p Pod trÃªn báº¥t ká»³ node nÃ o trong cá»¥m truy cáº­p vÃ o dá»¯ liá»‡u má»™t cÃ¡ch nháº¥t quÃ¡n. Longhorn cÅ©ng cung cáº¥p dashboard trá»±c quan Ä‘á»ƒ giÃ¡m sÃ¡t dÆ°Æ¡ng lÆ°á»£ng trá»‘ng trÃªn cÃ¡c node vÃ  tÃ¬nh tráº¡ng cÃ¡c Volume, thuáº­n tiá»‡n cho viá»‡c quáº£n lÃ½ á»• Ä‘Ä©a. Äá»ƒ triá»ƒn khai Longhorn, cá»¥m cáº§n cÃ³ Ã­t nháº¥t 3 node vÃ  má»—i node pháº£i cÃ³ á»• Ä‘Ä©a trá»‘ng Ä‘á»ƒ Longhorn quáº£n lÃ½.

#### MinIO

![MinIO archi](./img/MinIO_archi.png)

MinIO lÃ  má»™t mÃ¡y chá»§ lÆ°u trá»¯ Ä‘á»‘i tÆ°á»£ng (object storage) mÃ£ nguá»“n má»Ÿ, tÆ°Æ¡ng thÃ­ch vá»›i API cá»§a Amazon S3. Trong há»‡ thá»‘ng nÃ y, MinIO Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ lÆ°u trá»¯ dá»¯ liá»‡u cá»§a WordPress vÃ  InfluxDB v2. Má»¥c Ä‘Ã­ch cá»§a MinIO lÃ  cung cáº¥p má»™t giáº£i phÃ¡p lÆ°u trá»¯ hiá»‡u quáº£, cÃ³ thá»ƒ má»Ÿ rá»™ng cho cÃ¡c Ä‘á»‘i tÆ°á»£ng dá»¯ liá»‡u lá»›n, giÃºp dá»… dÃ ng truy cáº­p vÃ  quáº£n lÃ½ káº¿t quáº£ kiá»ƒm thá»­ má»™t cÃ¡ch táº­p trung.

---

### HA Application

> CÃ¡i nÃ y thÃ¬ tÃ´i vÃ  cáº­u áº¥y triá»ƒn khai WordPress vá»›i MariaDB, truy váº¥n tá»« ngÆ°á»i dÃ¹ng sáº½ Ä‘áº¿n Nginx Ingress Controller trÆ°á»›c rá»“i má»›i chuyá»ƒn tiáº¿p tá»›i cÃ¡c pod WordPress, WordPress Ä‘Æ°á»£c cáº¥u hÃ¬nh nhiá»u pod Ä‘á»ƒ chá»‹u lá»—i vÃ  cÃ³ kháº£ nÄƒng auto-scale khi sá»‘ lÆ°á»£ng request lá»›n :> WordPress xá»­ lÃ½ request rá»“i gá»i MariaDB náº¿u cáº§n, trÆ°á»›c MariaDB thÃ¬ cÅ©ng cÃ³ ProxySQL Ä‘á»ƒ caching vÃ  phÃ¢n phá»‘i SQL request giÃºp giáº£m táº£i, tá»‘i Æ°u thá»i gian xá»­ lÃ½, MariaDB nÃ y cÃ i Ä‘áº·t á»Ÿ dáº¡ng Cluster (MariaDB Galera) vá»›i 1 pods master read/write vÃ  2 pods slave read Ä‘á»ƒ Ä‘áº£m báº£o Ä‘á»“ng bá»™ dá»¯ liá»‡u ghi vÃ o mÃ  váº«n xá»­ lÃ½ song song cÃ¡c dá»¯ liá»‡u Ä‘á»c ra. Hong cÃ³ sÆ¡ Ä‘á»“ cá»¥ thá»ƒ nhÆ°ng mÃ  má»i ngÆ°á»i cÃ³ thá»ƒ tham kháº£o hÃ¬nh nÃ y hoáº·c search vá»›i keyword **"High Availability Web/App design and deployment best practice"**.

![HA webapp](./img/HA_deployment.jpg)

## KhÃ³ khÄƒn vÃ  cÃ¡ch giáº£i quyáº¿t

> Con Ä‘Æ°á»ng nÃ o mÃ  cháº³ng cÃ³ chÃ´ng gai, quan trá»ng lÃ  Ã½ chÃ­ cá»§a mÃ¬nh vÃ  cÃ¡ch mÃ¬nh vÆ°á»£t qua Ä‘Ãºng khÃ´ng nÃ o ~

1. Váº¥n Ä‘á» tÃ i nguyÃªn

   á»œ thÃ¬ lÃºc Ä‘áº§u chÃºng tÃ´i cÃ i Ä‘áº·t K8s á»Ÿ Local, tuy nhiÃªn cÃ i Ä‘áº·t thÃ¬ Ä‘Æ°á»£c chá»© cháº¡y thÃ¬ khÃ´ng `âŠ™ï¹âŠ™âˆ¥`. Má»—i láº§n cháº¡y test cÃ¡i lÃ  Ä‘á»©ng mÃ¡y luÃ´n, huhu. LÃºc Ä‘áº§u tÃ´i cÅ©ng chÆ°a biáº¿t giáº£i quyáº¿t sao, nhÆ°ng mÃ  lÃºc bÃ¡o cÃ¡o vá»›i Sáº¿p thÃ¬ anh nÃ³i Ä‘á»ƒ anh cáº¥p mÃ¡y áº£o Ä‘á»ƒ SSH tá»›i sá»­ dá»¥ng, vÃ  há»i tÃ´i sao khÃ´ng Ä‘á»§ tÃ i nguyÃªn mÃ  khÃ´ng bÃ¡o sá»›m, cáº§n cho cÃ´ng viá»‡c thÃ¬ cá»© nÃ³i vá»›i anh. LÃºc Ä‘Ã³ nháº¹ nhÃµm háº³n, do chÆ°a quen má»i ngÆ°á»i vá»›i cÅ©ng khÃ´ng biáº¿t cÃ³ quyá»n xin cáº¥p mÃ¡y áº£o nÃªn chÃºng tÃ´i khÃ´ng dÃ¡m hÃ³ hÃ© gÃ¬ :v NÃªn lÃ  má»i ngÆ°á»i cÃ³ thá»±c táº­p thÃ¬ cá»© máº¡nh dáº¡n há»i, Ä‘á» xuáº¥t vá»›i ngÆ°á»i hÆ°á»›ng dáº«n nha.

2. Váº¥n Ä‘á» phÃ¢n quyá»n

   Má»i ngÆ°á»i cÃ²n nhá»› chá»— chÃºng tÃ´i nÃ³i Ä‘Æ°á»£c cáº¥p quyá»n Cluster Owner trong K8s chá»©? ChÃ , tháº­t sá»± thÃ¬ Ä‘Ã¡ng láº½ intern chá»‰ cÃ³ quyá»n lÃ  Developer thÃ´i, vÃ  sáº½ bá»‹ háº¡n cháº¿ vá»›i má»™t sá»‘ tÃ¡c vá»¥, tuy nhiÃªn lÃºc cÃ i Ä‘áº·t Testkube thÃ¬ cáº§n pháº£i cÃ i Ä‘áº·t CRDs (Custom Resource Definition) vÃ  cÃ¡i nÃ y cáº§n cÃ³ Cluster Role - quyá»n quáº£n lÃ½ Cluster :v Sau khi trÃ¬nh bÃ y thÃ¬ anh Sáº¿p quyáº¿t Ä‘á»‹nh táº¡o má»™t cluster má»›i cho chÃºng tÃ´i vÃ  cáº¥p luÃ´n Cluster Owner, haha. NhÆ°ng mÃ  chá»‰ thao tÃ¡c qua Rancher Dashboard thÃ´i, cÃ¡c Node trong cluster muá»‘n thao tÃ¡c váº«n pháº£i thÃ´ng qua sáº¿p vÃ  anh Cluster Admin tháº­t sá»± :>

3. Váº¥n Ä‘á» Teamwork

   CÃ¡i nÃ y thÃ¬ do chÃºng tÃ´i cÃ³ lÃ m nhÃ³m vá»›i má»™t báº¡n ná»¯a, cÆ¡ mÃ  cháº³ng may báº¡n áº¥y pháº£i náº±m viá»‡n háº¿t vÃ i tuáº§n :v cÆ¡ mÃ  do trÆ°á»›c Ä‘Ã³ chÃºng tÃ´i khÃ´ng Ä‘á»“ng bá»™ cÃ´ng viá»‡c vá»›i nhau, má»—i ngÆ°á»i má»™t viá»‡c nÃªn thÃ nh ra lÃºc nháº­n viá»‡c cá»§a báº¡n Ä‘Ã³ thÃ¬ tÃ´i tá»‘n khÃ¡ nhiá»u thá»i gian Ä‘á»ƒ náº¯m Ä‘Æ°á»£c, sau khi báº¡n Ä‘Ã³ trá»Ÿ láº¡i thÃ¬ cÅ©ng pháº£i tá»‘n khÃ¡ nhiá»u thá»i gian Ä‘á»ƒ Ä‘á»“ng bá»™ vá»›i nhau. Má»i ngÆ°á»i khi lÃ m viá»‡c nhÃ³m náº¿u Ä‘Æ°á»£c thÃ¬ trÃ² chuyá»‡n vá»›i thÃ nh viÃªn trong nhÃ³m nhiá»u hÆ¡n Ä‘á»ƒ náº¯m báº¯t khÃ³ khÄƒn vÃ  tiáº¿n Ä‘á»™ cá»§a thÃ nh viÃªn nha, náº¿u Ä‘Æ°á»£c thÃ¬ há»p Ä‘á»‹nh ká»³ Ä‘á»ƒ Ä‘á»“ng bá»™ cÃ´ng viá»‡c vá»›i nhau, Ä‘áº£m báº£o má»i ngÆ°á»i Ä‘á»u hiá»ƒu Ä‘Æ°á»£c cÃ´ng viá»‡c cá»§a nhau vÃ  cÃ³ thá»ƒ giá»¯ vá»¯ng tiáº¿n Ä‘á»™ dÃ¹ cÃ³ thÃªm hay bá»›t thÃ nh viÃªn. VÃ  cÃ¢n nháº¯c nÄƒng lá»±c cá»§a thÃ nh viÃªn mÃ  chia viá»‡c cho há»£p lÃ½ nha :>

4. Váº¥n Ä‘á» ká»¹ nÄƒng, kiáº¿n thá»©c

   ChÃ , thá»i nÃ y mÃ  khÃ´ng dÃ¹ng AI thÃ¬ xá»©ng Ä‘Ã¡ng Ä‘Æ°á»£c báº£o tá»“n Ä‘Ã³ chá»©. NÃ³i tháº¿ chá»© dÃ¹ng AI cÅ©ng pháº£i tÃ¹y viá»‡c má»i ngÆ°á»i áº¡, vÃ­ dá»¥ nhÆ° lÃºc Ä‘áº§u Ä‘á»c document cÃ¡c cÃ´ng cá»¥ cáº§n triá»ƒn khai, chÃºng tÃ´i Ä‘á»u Ä‘Æ°a cho GPT, Gemini, Grok... tÃ³m táº¯t vÃ  xá»­ lÃ½ háº¿t, tiáº¿t kiá»‡m thá»i gian Ä‘áº¥y nhÆ°ng mÃ  cháº³ng cÃ³ cÃ¡i nÃ o dÃ¹ng Ä‘Æ°á»£c cáº£, táº¡i nÃ³ khÃ´ng Ä‘Ãºng template hoáº·c lÃ  version khÃ´ng khá»›p. Má»i ngÆ°á»i chá»‰ nÃªn nhá» nÃ³ tÃ¬m thÃ´i, cÃ²n mÃ¬nh thÃ¬ váº«n pháº£i tá»± Ä‘á»c má»›i Ä‘Æ°á»£c. Hoáº·c vÃ­ nhÆ° viá»‡c viáº¿t ká»‹ch báº£n test, do lÃºc trÆ°á»›c chá»‰ há»c sÆ¡ sÆ¡ máº¥y cÃ¡i JavaScript trong mÃ´n Láº­p trÃ¬nh á»©ng dá»¥ng Web nÃªn tÃ´i vÃ  cáº­u áº¥y cÅ©ng khÃ´ng náº¯m rÃµ cÃº phÃ¡p, chá»©c nÄƒng. Nhá» GPT lÃ m thÃ¬ cÅ©ng Ä‘Æ°á»£c thÃ´i, nhÆ°ng mÃ  pháº£i hiá»ƒu script Ä‘ang lÃ m gÃ¬ nhÃ©, chá»© khÃ´ng sáº¿p mÃ  kÃªu tÃ¹y chá»‰nh mÃ  láº¡i má»Ÿ GPT lÃªn thÃ¬ ba cháº¥m láº¯m Ä‘Ã³. CÃ¡i nÃ y má»i ngÆ°á»i cÃ³ thá»ƒ nhá» AI há»— trá»£ syntax, function, cáº¥u trÃºc chÆ°Æ¡ng trÃ¬nh cÃ¡c thá»©, chá»© Ä‘á»«ng Ä‘á»ƒ AI lÃ m háº¿t, má»i ngÆ°á»i cáº§n náº¯m Ä‘Æ°á»£c input, output vÃ  quÃ¡ trÃ¬nh xá»­ lÃ½ (Ã½ tÆ°á»Ÿng hoáº·c luá»“ng xá»­ lÃ½ chi tiáº¿t) cÃ²n láº¡i thÃ¬ cÃ³ thá»ƒ dÃ¹ng AI, sá»­a script nhiá»u rá»“i cÅ©ng tá»± Ä‘á»™ng quen syntax, cÃº phÃ¡p thÃ´i :v

## NgÃ y cuá»‘i cÃ¹ng

> 3 thÃ¡ng thá»±c táº­p tháº¿ chá»© nhanh láº¯m má»i ngÆ°á»i áº¡, nháº¯m máº¯t cÃ¡i lÃ  háº¿t rá»“i, cÅ©ng nhÆ° 4 nÄƒm Ä‘áº¡i há»c váº­y. NgÃ y cuá»‘i cÃ¹ng thÃ¬ buá»•i sÃ¡ng chÃºng tÃ´i Ä‘Æ°á»£c chá»‹ HR há»— trá»£ lÃ m phiáº¿u xÃ¡c nháº­n thá»±c táº­p luÃ´n. Äáº¿n trÆ°a thÃ¬ Ä‘i Äƒn cÅ©ng team thá»±c táº­p rá»“i mua bÃ³ hoa Ä‘á»ƒ chiá»u táº·ng cho Trung tÃ¢m (Sáº¿p Ä‘áº¡i diá»‡n nháº­n). CÃ´ng viá»‡c lÃºc Ä‘Ã³ thÃ¬ tÃ´i cÅ©ng hoÃ n thÃ nh gáº§n háº¿t rá»“i, chá»‰ lÃ  triá»ƒn khai cÃ¡i Website WordPress xong rá»“i nhÆ°ng mÃ  chÆ°a thá»­ nghiá»‡m háº¿t :v NhÆ°ng mÃ  anh Sáº¿p báº£o váº­y cÅ©ng Ä‘Æ°á»£c nÃªn khÃ´ng sao, hehe. HÃ´m Ä‘áº¥y thÃ¬ cÃ³ anh bÃªn team Dev má»i nÆ°á»›c má»i ngÆ°á»i ná»¯a :3 quÃ¡ Ä‘Ã£. Ã€, á»Ÿ trung tÃ¢m thÃ¬ máº¥y anh chá»‹ hay má»i bÃ¡nh, trÃ¡i cÃ¢y vÃ  nÆ°á»›c láº¯m, nÃªn Ä‘i thá»±c táº­p Ä‘Æ°á»£c Äƒn uá»‘ng quÃ¡ trá»i luÃ´n :33 hehe. Má»i ngÆ°á»i ai cÅ©ng vui váº», thÃ¢n thiá»‡n háº¿t, lÃ m viá»‡c ráº¥t thoáº£i mÃ¡i luÃ´n. Anh Sáº¿p thÃ¬ hÆ¡i Ã­t nÃ³i nhÆ°ng hay Ä‘á»™ng viÃªn láº¯m, vá»›i há»… cáº§n gÃ¬ lÃ  áº£nh nÃ³i máº¥y anh chá»‹ há»— trá»£ liá»n, cÃ²n cÃ³ máº¥y láº§n chÃºng tÃ´i lÃ m sáº­p há»‡ thá»‘ng ná»¯a nhÆ°ng mÃ  áº£nh khÃ´ng trÃ¡ch máº¯ng gÃ¬, chá»‰ há»i chÃºng tÃ´i biáº¿t nguyÃªn ngÃ¢n vÃ  cÃ¡ch kháº¯c phá»¥c khÃ´ng Ä‘á»ƒ ghi vÃ o bÃ¡o cÃ¡o thÃ´i. NgoÃ i ra, trong lÃºc thá»±c táº­p thÃ¬ may máº¯n Ä‘Æ°á»£c lÃ m gÆ°Æ¡ng máº·t quáº£ng bÃ¡ cho Trung tÃ¢m ná»¯a, haha, má»i ngÆ°á»i cÃ³ theo dÃµi cháº¯c cÅ©ng tháº¥y tÃ´i vÃ  cáº­u áº¥y lÃªn hÃ¬nh kha khÃ¡ nhá»‰.\
> \
> Hehe, bÃ i dÃ i quÃ¡ trá»i gÃ²i, cÃ¡m Æ¡n má»i ngÆ°á»i vÃ¬ Ä‘Ã£ Ä‘á»c Ä‘áº¿n táº­n Ä‘Ã¢y nha :3 Táº¡m biá»‡t vÃ  háº¹n gáº·p láº¡i.
